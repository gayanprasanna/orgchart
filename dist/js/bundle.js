!function(){"use strict";angular.module("orgChart",[])}(),function(){"use strict";function e(e,t,n){function o(o){function r(e){var t=angular.lowercase(e);return function(e){return 0===e.name.toLowerCase().indexOf(t)}}var i=this;i.simulateQuery=!1,i.isDisabled=!1,i.noCache=!0,i.querySearch=function(n){console.log(i.searchableList);var o,a=n?i.searchableList.filter(r(n)):i.searchableList;return i.simulateQuery?(o=t.defer(),e(function(){o.resolve(a)},1e3*Math.random(),!1),o.promise):a},i.selectedItemChange=function(e){e&&(n.info("Item changed to "+JSON.stringify(e)),o.setSearchedNode(e))},i.searchTextChange=function(e){n.info("Text changed to "+e)},i.newState=function(e){alert("Sorry! You'll need to create a Constitution for "+e+" first!")}}return o.$inject=["treeViewService"],{replace:!1,restrict:"EA",controller:o,template:'<div layout-align="start center" layout="row" layout-fill> <div flex-offset="5" class="search-box-holder"> <md-autocomplete ng-disabled="vm.isDisabled" md-no-cache="vm.noCache" md-selected-item="vm.selectedItem" md-search-text-change="vm.searchTextChange(vm.searchText)" md-search-text="vm.searchText" md-selected-item-change="vm.selectedItemChange(item)" md-items="item in vm.querySearch(vm.searchText)" md-item-text="item.name" md-min-length="0" placeholder="Search People" class="auto-complete-custom"> <md-item-template> <span md-highlight-text="ctrl.searchText" md-highlight-flags="^i">{{item.name}}</span> </md-item-template> <md-not-found> No states matching "{{ctrl.searchText}}" were found. <a ng-click="ctrl.newState(ctrl.searchText)">Create a new one!</a> </md-not-found> </md-autocomplete> </div><div flex class="btn-search-holder"><button class="btn-search" type="button"><i class="fa fa-search"></i> </button></div></div>',controllerAs:"vm",scope:{},bindToController:{searchableList:"="},link:function(){}}}e.$inject=["$timeout","$q","$log"],angular.module("orgChart").directive("treeSearchBox",e)}(),function(){"use strict";function e(e){var t=this;t.isExpandAllMode=e.isExpandAllMode(),t.toggleExpandAllMode=function(){t.isExpandAllMode=e.toggleExpandAllMode()},t.zoomTrigger=function(e){t.zoomTriggerCallBack({status:e})},t.zoomScale=e.getZoomScale()}e.$inject=["toolSetService"],angular.module("orgChart").directive("treeToolSet",function(){return{replace:!1,restrict:"EA",controller:e,controllerAs:"vm",template:'<div layout="column" layout-align="center end"> <div layout="column" layout-align="space-around center" class="toolset-wrapper" flex-offset="5"> <div> <button class="toolset-btn upper-rounded" ng-click="vm.zoomTrigger(\'increment\')"> <md-tooltip md-direction="bottom">Zoom In</md-tooltip> <md-icon><i ng-class="{\'fa fa-plus\':true,\'custom-font-icon\':true}"></i></md-icon></button> </div><div> <button class="toolset-btn lower-rounded" ng-click="vm.zoomTrigger(\'decrement\')"> <md-tooltip md-direction="bottom">Zoom Out</md-tooltip> <md-icon><i ng-class="{\'fa fa-minus\':true,\'custom-font-icon\':true}"></i></md-icon></button> </div><div style="margin-top: 10px"> <button class="toolset-btn" ng-click="vm.toggleExpandAllMode()"> <md-tooltip md-direction="bottom"><span ng-if="!vm.isExpandAllMode">Expand All</span><span ng-if="vm.isExpandAllMode">Collapse All</span></md-tooltip> <md-icon><i ng-class="{\'fa fa-expand\':!vm.isExpandAllMode,\'fa fa-compress\':vm.isExpandAllMode,\'custom-font-icon\':true}"></i> </md-icon></button> </div></div></div>',scope:{},bindToController:{zoomTriggerCallBack:"&"},link:function(e,t,n,o){}}})}(),function(){"use strict";angular.module("orgChart").factory("toolSetService",function(){var e=!1,t=1;return{isExpandAllMode:function(){return e},toggleExpandAllMode:function(){return e=!e},getZoomScale:function(){return console.log("getZoom Scale",t),t},setZoomScale:function(e){t=e,console.log("zoom scale",t)},incrementZoomScale:function(){return t+=.1},decrementZoomScale:function(){return t>-2.5&&(t-=.1),t}}})}(),function(){"use strict";function e(e,n,o,r){return{restrict:"E",replace:!1,controller:t,template:'<div ng-class="{\'active-node\':vm.isActive}" class="{{vm.nodeClass}}" ng-mouseenter="vm.whenMouseEnter()" ng-mouseleave="vm.whenMouseLeave()" ng-click="vm.makeNodeActive()"> <div layout="column" layout-align="center center"> <div ng-class="{\'node-text-main-no-image\':!vm.isImagePresent}" class="md-subhead node-text-main"><trim-word word-options ="vm.wordTrimOptions" word="vm.node.name"></trim-word></div><div> <div class="round-chip-wrapper"><img ng-if="vm.isImagePresent" ng-src="{{vm.node.image_url}}" class="round-chip"> </div></div><div  ng-class="{\'node-text-sub-no-image\':!vm.isImagePresent}" class="md-subhead node-text-sub">{{vm.node.name}}</div><div layout-align="center center" layout-fill layout="row"> <div ng-repeat="action in vm.nodeActions"> <button ng-click="vm.makeCallBack(action.callBack); $event.stopPropagation();" class="action-btn"><span></span>&nbsp;<i class="{{action.icon}}"></i></button> </div></div></div></div>',controllerAs:"vm",scope:{},bindToController:{nodeId:"@",nodeActions:"@"},link:{pre:function(t,n,i,a){function l(){r.$broadcast("app:nodes:clearactive",{data:""})}function c(e){n===e.target||n[0].contains(e.target)||t.$apply(function(){a.isActive=!1})}console.log(i.imagepresent),a.isImagePresent="true"==i.imagepresent,a.id=i.nodeid,a.nodeActions=angular.fromJson(i.nodeactions),console.log(a.nodeActions),a.isPinnedNode=!1,a.node=e.findById(i.nodeid),a.wordTrimOptions={word:"d",from:"0",until:"12",toolTip:"true",toolTipDirection:"top"},a.nodeClass="node-label node-"+a.node.type+" node-"+a.id,a.isExpandedView=!1,a.isActive=!1,a.whenMouseEnter=function(){console.log("mouse Entered")},a.whenMouseLeave=function(){console.log("mouse leaved")},a.togglePinnedMode=function(){a.isPinnedNode=!0,console.log(a.isPinnedNode)},a.makeCallBack=function(e){console.log(e),t.$parent.vm.makeCallBack(e,a.node)},a.makeNodeActive=function(){l(),a.isActive=!0};angular.element(n.children()[0]);o.on("click",c),t.$on("$destroy",function(){o.off("click",c)})}}}}function t(e){}e.$inject=["treeViewService","$timeout","$document","$rootScope"],t.$inject=["treeViewService"],angular.module("orgChart").directive("treeNode",e)}(),function(){"use strict";function e(e,n,o,r,i,a){return{replace:"false",restrict:"E",scope:{},bindToController:{data:"=",abn:"&",del:"&",add:"&",edit:"&",nodeActions:"@",treedata:"=",searchableList:"=",imagepresent:"="},controller:t,controllerAs:"vm",link:{pre:function(t,l,c,d){function s(){m(),u()}function u(){t.$watch(function(){return i.isExpandAllMode()},function(e){e?f():h()})}function f(){g(.5),i.setZoomScale(.5),W(),k()}function h(){g(1),i.setZoomScale(1),W(),S()}function m(){t.$watch(function(){return o.getSearchedNode()},function(e){if(console.log(e),e){O(e);var t=V(e);D(),r(function(){console.log(t.x,t.y),H(),Q(t.id),L(t)},500)}})}function g(e){var t={x:0,y:0,k:e};K([t.x,t.y],t.k)}function v(e,t){me=e,d3.select(t).select(".ghost-area").attr("pointer-events","none"),d3.selectAll(".ghost-area").attr("class","ghost-area show"),d3.select(t).attr("class","node active-drag"),_e.selectAll("g.node").sort(function(e,t){return e.id!=me.id?1:-1}),G.length>1&&(te=Ne.links(G),ne=_e.selectAll("path.link").data(te,function(e){return e.target.id}).remove(),oe=_e.selectAll("g.node").data(G,function(e){return e.id}).filter(function(e,t){return e.id!=me.id}).remove()),re=Ne.links(Ne.nodes(me.parent)),_e.selectAll("path.link").filter(function(e,t){return e.target.id==me.id}).remove(),fe=null}function p(e,t){var n,o,r,a=ge;X&&(clearTimeout(X),ee=d3.transform(_e.attr("transform")),"left"==t||"right"==t?(n="left"==t?ee.translate[0]+a:ee.translate[0]-a,o=ee.translate[1]):"up"!=t&&"down"!=t||(n=ee.translate[0],o="up"==t?ee.translate[1]+a:ee.translate[1]-a),ee.scale[0],ee.scale[1],r=i.getZoomScale(),_e.transition().attr("transform","translate("+n+","+o+")scale("+r+")"),d3.select(e).select("g.node").attr("transform","translate("+n+","+o+")"),Te.scale(r),Te.translate([n,o]),X=setTimeout(function(){p(e,a,t)},50))}function x(){he=null,d3.selectAll(".ghost-area").attr("class","ghost-area"),d3.select(R).attr("class","node"),d3.select(R).select(".ghost-area").attr("pointer-events",""),Ee(),null!==me&&(A(se),L(me),me=null)}function y(e){e.children&&(e.children.forEach(y),T(e))}function w(e){var t=e.children?e.children:e._children;e._children&&(e.children=e._children,e._children=null),t&&t.forEach(w)}function b(e){var t=e.children?e.children:e._children;e.children&&(e._children=e.children,e.children=null),t&&t.forEach(b)}function k(){w(se),A(se)}function S(){b(se),A(se)}function A(e){var r=d3.event&&d3.event.altKey?5e3:500,i=Ne.nodes(se).reverse();i.forEach(function(e){e.y=300*e.depth});var a=_e.selectAll("g.node").data(i,function(e){return e.id||(e.id=++be)}),l=a.enter().append("svg:g").call(de).attr("class","node").attr("id",function(e){return"node-"+e.id}).attr("transform",function(t){return"translate("+e.x0+","+e.y0+")"}).on("click",function(e){d3.event.defaultPrevented||(T(e),A(e))});l.append("rect").attr("class","ghost-area").attr("width",ue.width).attr("height",ue.height+150).attr("opacity",.2).style("fill","transparent").attr("pointer-events","mouseover").on("mouseover",function(e){$e(e)}).on("mouseout",function(e){Ce(e)}),l.append("svg:foreignObject").attr("text-anchor",function(e){return e.children||e._children?"end":"start"}).style("fill-opacity",1e-6).attr("width",ue.width).attr("height",ue.height).append("xhtml:div").classed("disabled",function(e){return void 0!==e.enable&&!e.enable}).on("click",I).append("tree-node").attr("node",function(e){return o.pushNode(e),""}).attr("nodeId",function(e){return e.id}).attr("imagePresent",function(e){return d.imagepresent}).attr("isPinnedNode","false").attr("nodeActions",c.nodeactions).each(function(){n(this)(t)}),a.transition().duration(r).attr("transform",function(e){return"translate("+e.x+","+e.y+")"});var s=a.exit().transition().duration(r).attr("transform",function(t){return"translate("+e.x+","+e.y+")"}).remove();s.select("circle").attr("r",1e-6),s.select("text").style("fill-opacity",1e-6);var u=_e.selectAll("path.link").data(Ne.links(i),function(e){return e.target.id});u.enter().insert("svg:path","g").attr("class","link").attr("d",function(t){var n={x:e.x0,y:e.y0};return Me({source:n,target:n})}).transition().duration(r).attr("d",Me),u.transition().duration(r).attr("d",Me).style("stroke",function(e){if("highlight-link"===e.target.class)return"#ff4136"}),u.exit().transition().duration(r).attr("d",function(t){var n={x:e.x,y:e.y};return Me({source:n,target:n})}).remove(),i.forEach(function(e){e.x0=e.x,e.y0=e.y}),angular.copy(i,ve),o.setNodes(ve)}function T(e){e.children?(e._children=e.children,e.children=null):(e.children=e._children,e._children=null)}function E(e,t){Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,9),M(e.id,t)}function C(e){var t=e.parent.children.indexOf(e);t>-1&&e.parent.children.splice(t,1),_(se.children,e),A(e.parent),z()}function _(e,t){angular.forEach(e,function(n,o){if(t.id==n.id){var r=e.indexOf(n);r>-1&&e.splice(r,1)}else angular.isDefined(n.children)&&null!==n.children&&_(n.children,t)})}function N(e,t){angular.forEach(e,function(n,o){if(t.id==n.id){var r=e.indexOf(n);r>-1&&(e[r].name=t.name)}else angular.isDefined(n.children)&&null!==n.children&&_(n.children,t)})}function M(e,t){var n=d3.select("#node-"+e).datum();void 0===n.children&&void 0===n._children?n.children=[t]:null!=n._children?(n._children.push(t),T(n)):null!=n.children?n.children.push(t):null==n._children&&(n._children=[],n._children.push(t),T(n)),A(n)}function z(){d3.event.stopPropagation()}function I(e){d3.event.defaultPrevented||(console.log(e),j(this)||L(e))}function O(e){var t=B(d.treedata,e.name,[]);angular.isDefined(t)?(Z(Ae),P(t)):console.log("Searched node "+e.name+" not found"),Ae=t}function P(e){angular.forEach(e,function(e,t){e.class="highlight-link",e._children&&(e.children=e._children,e._children=null),A(e)})}function Z(e){angular.forEach(e,function(e,t){e.class="",e._children&&(e.children=e._children,e._children=null),A(e)})}function B(e,t,n){if(e.name===t)return n.push(e),n;if(!e.children&&!e._children)return!1;for(var o=e.children?e.children:e._children,r=0;r<o.length;r++){n.push(e);var i=B(o[r],t,n);if(i)return i;n.pop()}}function j(e){var t=!1;return ze.node()===e&&(t=D()),!!t||(ze.classed("active",!1),ze=d3.select(e).classed("active",!0),!1)}function L(e){var t=i.getZoomScale(),n=[-t*e.x,-t*e.y];console.log("node",e),console.log("node translate ",n),_e.transition().duration(1250).call(Te.translate(n).scale(t).event)}function D(){return console.log("reset called"),ze.classed("active",!1),ze=d3.select(null),!0}function V(t){return e("filter")(ve,{id:t.id},!0)[0]}function q(t){return e("filter")(ve,{id:t},!0)[0]}function W(){J(0,0)}function J(e,t){_e.transition().duration(1e3).delay(100).attr("transform",function(n){return"translate("+e+","+t+")scale("+i.getZoomScale()+")"})}function Q(e){var t=d3.selectAll(".node-"+e.toString());angular.element(t[0]).addClass("active-node")}function H(){var e=d3.selectAll(".node-label");angular.forEach(e,function(e,t){angular.element(e).removeClass("active-node")})}function K(e,t){return d3.transition().duration(250).tween("wheel.zoom",function(){var n=d3.interpolate(Te.translate(),e),o=d3.interpolate(Te.scale(),t);return function(e){Te.scale(o(e)).translate(n(e)),F()}})}function Y(e){var t=1,n=1,o=[xe/2,we/2],r=Te.scaleExtent(),i=Te.translate(),a=[],l=[],c={x:i[0],y:i[1],k:Te.scale()};if(t="increment"===e?1:-1,(n=Te.scale()*(1+.2*t))<r[0]||n>r[1])return!1;a=[(o[0]-c.x)/c.k,(o[1]-c.y)/c.k],c.k=n,l=[a[0]*c.k+c.x,a[1]*c.k+c.y],c.x+=o[0]-l[0],c.y+=o[1]-l[1],K(Te.translate(),c.k)}function F(){console.log(Te.scale()),i.setZoomScale(Te.scale()),_e.attr("transform","translate("+Te.translate()+")scale("+i.getZoomScale()+")")}var G,R,U,X,ee,te,ne,oe,re,ie,ae,le,ce,de,se,ue={width:240,height:146,horizontalSeperation:16,verticalSeperation:128},fe=!1,he=null,me=null,ge=200,ve=[],pe=[20,20,20,20],xe=a.innerWidth-20-pe[1]-pe[3],ye=a.innerHeight,we=600-pe[0]-pe[2],be=0,ke=(d3.scale.linear().domain([0,xe]).range([0,xe]),d3.scale.linear().domain([0,we]).range([0,we]),"0 0 "+xe+" "+ye),Se=d3.select(l[0]),Ae=[],Te=d3.behavior.zoom().translate([0,0]).scale(i.getZoomScale()).scaleExtent([.3,8]).on("zoom",F);l.append(n("<div class='component-container'><div layout=\"row\" layout-align=\"space-around center\"><div flex><tree-search-box searchable-list='vm.searchableList'></tree-search-box></div><div flex><tree-tool-set zoom-trigger-call-back='vm.zoomTrigger(status)'></tree-tool-set></div></div></div>")(t)),d.zoomTrigger=function(e){console.log(e),Y(e)},de=d3.behavior.drag().on("dragstart",function(e){e!=se&&(fe=!0,G=Ne.nodes(e),d3.event.sourceEvent.stopPropagation())}).on("drag",function(e){if(e!=se){if(fe&&v(e,R=this),(U=d3.mouse($("svg").get(0)))[0]<20)X=!0,p(this,"left");else if(U[0]>$("svg").width()-20)X=!0,p(this,"right");else if(U[1]<20)X=!0,p(this,"up");else if(U[1]>$("svg").height()-20)X=!0,p(this,"down");else try{clearTimeout(X)}catch(e){console.error(e)}e.x0+=d3.event.dx,e.y0+=d3.event.dy,d3.select(this).attr("transform","translate("+e.x0+","+e.y0+")"),Ee()}}).on("dragend",function(e){if(e!=se)if(R=this,he){var t=me.parent.children.indexOf(me);t>-1&&me.parent.children.splice(t,1),void 0!==he.children||void 0!==he._children?void 0!==he.children?he.children.push(me):he._children.push(me):(he.children=[],he.children.push(me)),x()}else x()});var Ee=function(){var e=[];null!==me&&null!==he&&(e=[{source:{x:he.x0+ue.width/2,y:he.y0+ue.height+10},target:{x:me.x0+ue.width/2,y:me.y0}}]);var t=_e.selectAll(".temp-link").data(e);t.enter().append("path").attr("class","temp-link").attr("d",d3.svg.diagonal()).attr("pointer-events","none"),t.attr("d",d3.svg.diagonal()),t.exit().remove()},$e=function(e){he=e,Ee()},Ce=function(e){he=null,Ee()};s();var _e=Se.append("div").attr("layout","row").attr("layout-align","space-around center").call(function(){}).append("div").attr("flex","").call(function(){}).append("svg:svg").attr("viewBox",ke).attr("style","cursor:move;").attr("width","100%").attr("height",ye).call(Te).append("svg:g").attr("transform","translate("+(a.innerWidth/2-120)+","+we/4+")").attr("style","cursor:pointer;").on("click",z,!1).call(d3.behavior.drag().on("dragstart",function(){}).on("drag",function(){console.log("dragged")})).append("g").attr("width",160).attr("height",120).attr("class","tree-holder"),Ne=d3.layout.tree().nodeSize([ue.width+ue.horizontalSeperation,ue.height+ue.verticalSeperation]).separation(function(e,t){return e.parent==t.parent?1.25:1.5}),Me=(d3.svg.line().x(function(e){return xScale(e.x)}).y(function(e){return yScale(e.y)}),d3.svg.diagonal().source(function(e){return{x:e.source.x+ue.width/2,y:e.source.y+(ue.height+10)}}).target(function(e){return{x:e.target.x+ue.width/2,y:e.target.y-("true"==c.imagepresent?45:0)}}).projection(function(e){return[e.x+0,e.y+0]}));(se=d.treedata).x0=we/2,se.y0=0,console.log(se),se.children.forEach(y),A(se);var ze=d3.select(null);ie=t.$on("app:nodes:clearactive",function(e,t){H()}),ae=t.$on("app:nodes:delete",function(e,t){console.log(t),C(q(t.nodeID))}),le=t.$on("app:nodes:add::after",function(e,t){E(q(t.parentNode.id),t.lastAddedNode)}),ce=t.$on("app:nodes:update::after",function(e,t){N(se.children,t.lastEditedNode),A(t.lastEditedNode),z()}),t.$on("$destroy",function(){ie(),ae(),le(),ce()})}}}}function t(e,t,n){var o=this;o.makeCallBack=function(e,n){console.log("called treeview call back abn"),t.vm[e]({node:n})},console.log(o.searchableList)}e.$inject=["$filter","$compile","treeViewService","$timeout","toolSetService","$window"],t.$inject=["$rootScope","$scope","treeViewService"],angular.module("orgChart").directive("treeView",e)}(),function(){"use strict";function e(e){var t=null,n=[];return{setSearchedNode:function(e){t=e},getSearchedNode:function(){return t},setNodes:function(e){n=e},pushNode:function(e){n.push(e)},getNodes:function(){return n},findById:function(t){return e("filter")(n,{id:t},!0)[0]}}}e.$inject=["$filter"],angular.module("orgChart").factory("treeViewService",e)}(),function(){"use strict";function e(){}angular.module("orgChart").directive("trimWord",function(){return{restrict:"E",template:'<span ng-bind="vm.parsedText"><md-tooltip ng-if="vm.isToolTipNeed()" md-direction="vm.wordOptions.toolTipDirection">{{::vm.word}}</md-tooltip></span>',scope:{},controller:e,controllerAs:"vm",link:function(e,t,n,o){function r(){e.$watch(angular.bind(o,function(){return o.word}),function(e){console.log("word change to "+e),a()})}function i(){var e=parseInt(o.wordOptions.from),t=parseInt(o.wordOptions.until);return o.word.substring(e,t)}function a(){o.parsedText=i(),o.word.length>parseInt(o.wordOptions.until)?o.parsedText=o.parsedText.concat(" ..."):o.parsedText}o.isToolTipNeed=function(){return"true"==o.wordOptions.toolTip},r(),a()},bindToController:{wordOptions:"=",word:"="}}})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm9yZ2NoYXJ0Lm1vZHVsZS5qcyIsImRpcmVjdGl2ZXMvc2VhcmNoYm94LmRpcmVjdGl2ZS5qcyIsImRpcmVjdGl2ZXMvdG9vbHNldC5kaXJlY3RpdmUuanMiLCJkaXJlY3RpdmVzL3Rvb2xzZXQuc2VydmljZS5qcyIsImRpcmVjdGl2ZXMvdHJlZW5vZGUuZGlyZWN0aXZlLmpzIiwiZGlyZWN0aXZlcy90cmVldmlldy5kaXJlY3RpdmUuanMiLCJkaXJlY3RpdmVzL3RyZWV2aWV3LnNlcnZpY2UuanMiLCJkaXJlY3RpdmVzL3RyaW13b3JkLmRpcmVjdGl2ZS5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwidHJlZVNlYXJjaEJveCIsIiR0aW1lb3V0IiwiJHEiLCIkbG9nIiwiQ2FzY2FkZVRyZWVTZWFyY2hCb3hDb250cm9sbGVyIiwidHJlZVZpZXdTZXJ2aWNlIiwiY3JlYXRlRmlsdGVyRm9yIiwicXVlcnkiLCJsb3dlcmNhc2VRdWVyeSIsImxvd2VyY2FzZSIsInN0YXRlIiwibmFtZSIsInRvTG93ZXJDYXNlIiwiaW5kZXhPZiIsInZtIiwidGhpcyIsInNpbXVsYXRlUXVlcnkiLCJpc0Rpc2FibGVkIiwibm9DYWNoZSIsInF1ZXJ5U2VhcmNoIiwiY29uc29sZSIsImxvZyIsInNlYXJjaGFibGVMaXN0IiwiZGVmZXJyZWQiLCJyZXN1bHRzIiwiZmlsdGVyIiwiZGVmZXIiLCJyZXNvbHZlIiwiTWF0aCIsInJhbmRvbSIsInByb21pc2UiLCJzZWxlY3RlZEl0ZW1DaGFuZ2UiLCJpdGVtIiwiaW5mbyIsIkpTT04iLCJzdHJpbmdpZnkiLCJzZXRTZWFyY2hlZE5vZGUiLCJzZWFyY2hUZXh0Q2hhbmdlIiwidGV4dCIsIm5ld1N0YXRlIiwiYWxlcnQiLCJyZXBsYWNlIiwicmVzdHJpY3QiLCJjb250cm9sbGVyIiwidGVtcGxhdGUiLCJjb250cm9sbGVyQXMiLCJzY29wZSIsImJpbmRUb0NvbnRyb2xsZXIiLCJsaW5rIiwiZGlyZWN0aXZlIiwiVHJlZVRvb2xTZXQiLCJ0b29sU2V0U2VydmljZSIsImlzRXhwYW5kQWxsTW9kZSIsInRvZ2dsZUV4cGFuZEFsbE1vZGUiLCJ6b29tVHJpZ2dlciIsInN0YXR1cyIsInpvb21UcmlnZ2VyQ2FsbEJhY2siLCJ6b29tU2NhbGUiLCJnZXRab29tU2NhbGUiLCJlbGVtIiwiYXR0ciIsImZhY3RvcnkiLCJpc0FsbEV4cGFuZGVkTW9kZSIsInNldFpvb21TY2FsZSIsInNjYWxlIiwiaW5jcmVtZW50Wm9vbVNjYWxlIiwiZGVjcmVtZW50Wm9vbVNjYWxlIiwidHJlZU5vZGUiLCIkZG9jdW1lbnQiLCIkcm9vdFNjb3BlIiwiQ2FzY2FkZVRyZWVOb2RlQ29udHJvbGxlciIsIm5vZGVJZCIsIm5vZGVBY3Rpb25zIiwicHJlIiwiYXR0cnMiLCJjbGVhckFsbE90aGVyQWN0aXZlTm9kZXMiLCIkYnJvYWRjYXN0IiwiZGF0YSIsIm9uRG9jdW1lbnRDbGljayIsImV2IiwidGFyZ2V0IiwiY29udGFpbnMiLCIkYXBwbHkiLCJpc0FjdGl2ZSIsImltYWdlcHJlc2VudCIsImlzSW1hZ2VQcmVzZW50IiwiaWQiLCJub2RlaWQiLCJmcm9tSnNvbiIsIm5vZGVhY3Rpb25zIiwiaXNQaW5uZWROb2RlIiwibm9kZSIsImZpbmRCeUlkIiwid29yZFRyaW1PcHRpb25zIiwid29yZCIsImZyb20iLCJ1bnRpbCIsInRvb2xUaXAiLCJ0b29sVGlwRGlyZWN0aW9uIiwibm9kZUNsYXNzIiwidHlwZSIsImlzRXhwYW5kZWRWaWV3Iiwid2hlbk1vdXNlRW50ZXIiLCJ3aGVuTW91c2VMZWF2ZSIsInRvZ2dsZVBpbm5lZE1vZGUiLCJtYWtlQ2FsbEJhY2siLCJjYWxsQmFja0Z1bmNOYW1lIiwiJHBhcmVudCIsIm1ha2VOb2RlQWN0aXZlIiwiZWxlbWVudCIsImNoaWxkcmVuIiwib24iLCIkb24iLCJvZmYiLCJ0cmVlVmlldyIsIiRmaWx0ZXIiLCIkY29tcGlsZSIsIiR3aW5kb3ciLCJhYm4iLCJkZWwiLCJhZGQiLCJlZGl0IiwidHJlZWRhdGEiLCJUcmVlVmlld0RpcmVjdGl2ZUNvbnRyb2xsZXIiLCJhY3RpdmF0ZVdhdGNoZXJzIiwib25TZWFyY2hXYXRjaCIsIm9uRXhwYW5kV2F0Y2giLCIkd2F0Y2giLCJpc0luRXhwYW5kQWxsTW9kZSIsImV4cGFuZEFsbEluQ2hhaW4iLCJjb2xsYXBzZUFsbEluQ2hhaW4iLCJmb3JjZVNjYWxlIiwiY2VudGVyVGhlUm9vdCIsImV4cGFuZEFsbCIsImNvbGxhcHNlQWxsIiwiZ2V0U2VhcmNoZWROb2RlIiwiaGlnaGxpZ2h0UGF0aCIsInJlc29sdmVkTm9kZSIsImdldFRyZWVOb2RlQnlPYmplY3QiLCJyZXNldCIsIngiLCJ5IiwiY2xlYXJBbGxBY3RpdmVOb2RlcyIsInBhblRvVGhlTm9kZSIsInZpZXciLCJrIiwiaW50ZXJwb2xhdGVab29tIiwiaW5pdGlhdGVEcmFnIiwiZCIsImRvbU5vZGUiLCJkcmFnZ2luZ05vZGUiLCJkMyIsInNlbGVjdCIsInNlbGVjdEFsbCIsInZpcyIsInNvcnQiLCJhIiwiYiIsIm5vZGVzIiwibGVuZ3RoIiwibGlua3MiLCJ0cmVlIiwibm9kZVBhdGhzIiwicmVtb3ZlIiwibm9kZXNFeGl0IiwiaSIsInBhcmVudExpbmsiLCJwYXJlbnQiLCJkcmFnU3RhcnRlZCIsInBhbiIsImRpcmVjdGlvbiIsInRyYW5zbGF0ZVgiLCJ0cmFuc2xhdGVZIiwic3BlZWQiLCJwYW5TcGVlZCIsInBhblRpbWVyIiwiY2xlYXJUaW1lb3V0IiwidHJhbnNsYXRlQ29vcmRzIiwidHJhbnNmb3JtIiwidHJhbnNsYXRlIiwidHJhbnNpdGlvbiIsInpvb20iLCJzZXRUaW1lb3V0IiwiZW5kRHJhZyIsInNlbGVjdGVkTm9kZSIsInVwZGF0ZVRlbXBDb25uZWN0b3IiLCJ1cGRhdGUiLCJyb290IiwidG9nZ2xlQWxsIiwiZm9yRWFjaCIsInRvZ2dsZSIsImV4cGFuZEFsbEFmdGVyIiwiX2NoaWxkcmVuIiwiY29sbGFwc2VBbGxBZnRlciIsInNvdXJjZSIsImR1cmF0aW9uIiwiZXZlbnQiLCJhbHRLZXkiLCJyZXZlcnNlIiwiZGVwdGgiLCJub2RlRW50ZXIiLCJlbnRlciIsImFwcGVuZCIsImNhbGwiLCJkcmFnTGlzdGVuZXIiLCJ4MCIsInkwIiwiZGVmYXVsdFByZXZlbnRlZCIsIm5vZGVCb3VuZGFyaWVzIiwid2lkdGgiLCJoZWlnaHQiLCJzdHlsZSIsIm92ZXJJbkdob3N0QXJlYSIsIm91dE9mR2hvc3RBcmVhIiwiY2xhc3NlZCIsInVuZGVmaW5lZCIsImVuYWJsZSIsIm9uQ2xpY2tlZE5vZGUiLCJwdXNoTm9kZSIsImVhY2giLCJub2RlRXhpdCIsImV4aXQiLCJpbnNlcnQiLCJvIiwiZGlhZ29uYWwiLCJjbGFzcyIsImNvcHkiLCJub2RlTGlzdCIsInNldE5vZGVzIiwib25BZGROb2RlIiwiY2hpbGQiLCJ0b1N0cmluZyIsInN1YnN0ciIsImFkZENoaWxkTm9kZSIsIm9uUmVtb3ZlTm9kZSIsImluZGV4Iiwic3BsaWNlIiwiZmluZEludGhlUm9vdEFuZERlc3Rvcm95Iiwic3RvcFByb3BvZ2F0aW9uIiwibGlzdCIsInZhbHVlIiwia2V5IiwiaXNEZWZpbmVkIiwiZmluZEludGhlUm9vdEFuZFJlcGxhY2VOYW1lIiwicGFyZW50SWQiLCJuZXdOb2RlIiwibm9kZURhdGEiLCJkYXR1bSIsInB1c2giLCJzdG9wUHJvcGFnYXRpb24iLCJtYWtlQ2xpY2tlZE5vZGVBY3RpdmUiLCJwYXRoIiwic2VhcmNoV2l0aGluVHJlZSIsImNsZWFySGlnaExpZ2h0TGlua3MiLCJsYXN0U2VhcmNoZWRQYXRoIiwiaGlnaGxpZ2h0TGlua3MiLCJzZWFyY2hLZXkiLCJmb3VuZCIsInBvcCIsImlzUmVzZXQiLCJhY3RpdmUiLCJvYmplY3QiLCJnZXRUcmVlTm9kZUJ5SUQiLCJ0cmFuc2Zvcm1Ob2RlIiwieFBvcyIsInlQb3MiLCJkZWxheSIsImFkZENsYXNzIiwidiIsInJlbW92ZUNsYXNzIiwidHdlZW4iLCJpVHJhbnNsYXRlIiwiaW50ZXJwb2xhdGUiLCJpU2NhbGUiLCJ0Iiwiem9vbWVkIiwiem9vbUNsaWNrIiwidGFyZ2V0X3pvb20iLCJjZW50ZXIiLCJ3IiwiaCIsImV4dGVudCIsInNjYWxlRXh0ZW50IiwidHJhbnNsYXRlMCIsImwiLCJyZWxDb29yZHMiLCJub2RlQWN0aXZlQ2xlYXJMaXN0ZW5lciIsIm5vZGVEZWxldGVMaXN0ZW5lciIsIm5vZGVBZnRlckFkZExpc3RlbmVyIiwibm9kZUFmdGVyVXBkYXRlTGlzdGVuZXIiLCJob3Jpem9udGFsU2VwZXJhdGlvbiIsInZlcnRpY2FsU2VwZXJhdGlvbiIsIm0iLCJpbm5lcldpZHRoIiwiaUhlaWdodCIsImlubmVySGVpZ2h0Iiwidmlld0JveEJvdW5kYXJ5IiwibGluZWFyIiwiZG9tYWluIiwicmFuZ2UiLCJ3cmFwcGVyRWxlbWVudCIsImJlaGF2aW9yIiwiZHJhZyIsInNvdXJjZUV2ZW50IiwibW91c2UiLCIkIiwiZ2V0IiwiZSIsImVycm9yIiwiZHgiLCJkeSIsInN2ZyIsImxheW91dCIsIm5vZGVTaXplIiwic2VwYXJhdGlvbiIsImxpbmUiLCJ4U2NhbGUiLCJ5U2NhbGUiLCJwcm9qZWN0aW9uIiwibm9kZUlEIiwicGFyZW50Tm9kZSIsImxhc3RBZGRlZE5vZGUiLCJsYXN0RWRpdGVkTm9kZSIsIiRzY29wZSIsImlkZW50aWZpZXIiLCJzZXRPZm5vZGVzIiwiZ2V0Tm9kZXMiLCJ0cmltV29yZENvbnRyb2xsZXIiLCJiaW5kIiwicGFyc2VUZXh0IiwidHJpbVdvcmQiLCJmcm9tVmFsdWUiLCJwYXJzZUludCIsIndvcmRPcHRpb25zIiwidG9WYWx1ZSIsInN1YnN0cmluZyIsInBhcnNlZFRleHQiLCJjb25jYXQiLCJpc1Rvb2xUaXBOZWVkIl0sIm1hcHBpbmdzIjoiQ0FHQSxXQUNBLGFBQ0FBLFFBQUFDLE9BQUEsa0JDRkEsV0FDQSxhQUtBLFNBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBdUJBLFNBQUFDLEVBQUFDLEdBc0VBLFNBQUFDLEVBQUFDLEdBQ0EsSUFBQUMsRUFBQVYsUUFBQVcsVUFBQUYsR0FFQSxPQUFBLFNBQUFHLEdBQ0EsT0FBQSxJQUFBQSxFQUFBQyxLQUFBQyxj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QUwsSUFDQTNULEVBQUFrVSxXQUFBTixJQUNBNVQsRUFBQWdGLEtBQUFpRSxPQUFBNkssU0FBQTlULEVBQUErVCxZQUFBN08sT0FBQWxGLEVBQUFrVSxXQUFBbFUsRUFBQWtVLFdBQUFDLE9BQUEsUUFBQW5VLEVBQUFrVSxXQTlCQWxVLEVBQUFvVSxjQXdCQSxXQUNBLE1BQUEsUUFBQXBVLEVBQUErVCxZQUFBNU8sU0FwQkEyQixJQUNBNk0sS0FoQkExUixrQkFDQThSLFlBQUEsSUFDQS9PLEtBQUEiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDcmVhdGVkIGJ5IHVzZXIgb24gNy8xMC8xNy5cbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgYW5ndWxhci5tb2R1bGUoJ29yZ0NoYXJ0JyxbXSk7XG59KSgpOyIsIi8qKlxuICogQ3JlYXRlZCBieSB1c2VyIG9uIDYvMS8xNy5cbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnb3JnQ2hhcnQnKS5kaXJlY3RpdmUoJ3RyZWVTZWFyY2hCb3gnLCB0cmVlU2VhcmNoQm94KTtcblxuICAgIC8qQG5nSW5qZWN0Ki9cbiAgICBmdW5jdGlvbiB0cmVlU2VhcmNoQm94KCR0aW1lb3V0LCAkcSwgJGxvZykge1xuXG4gICAgICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICAgICAgICByZXBsYWNlOiBmYWxzZSxcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogQ2FzY2FkZVRyZWVTZWFyY2hCb3hDb250cm9sbGVyLFxuICAgICAgICAgICAgLy8gdGVtcGxhdGVVcmw6ICdzZWFyY2hib3gudG1wbC5odG1sJyxcbiAgICAgICAgICAgIHRlbXBsYXRlOic8ZGl2IGxheW91dC1hbGlnbj1cInN0YXJ0IGNlbnRlclwiIGxheW91dD1cInJvd1wiIGxheW91dC1maWxsPiA8ZGl2IGZsZXgtb2Zmc2V0PVwiNVwiIGNsYXNzPVwic2VhcmNoLWJveC1ob2xkZXJcIj4gPG1kLWF1dG9jb21wbGV0ZSBuZy1kaXNhYmxlZD1cInZtLmlzRGlzYWJsZWRcIiBtZC1uby1jYWNoZT1cInZtLm5vQ2FjaGVcIiBtZC1zZWxlY3RlZC1pdGVtPVwidm0uc2VsZWN0ZWRJdGVtXCIgbWQtc2VhcmNoLXRleHQtY2hhbmdlPVwidm0uc2VhcmNoVGV4dENoYW5nZSh2bS5zZWFyY2hUZXh0KVwiIG1kLXNlYXJjaC10ZXh0PVwidm0uc2VhcmNoVGV4dFwiIG1kLXNlbGVjdGVkLWl0ZW0tY2hhbmdlPVwidm0uc2VsZWN0ZWRJdGVtQ2hhbmdlKGl0ZW0pXCIgbWQtaXRlbXM9XCJpdGVtIGluIHZtLnF1ZXJ5U2VhcmNoKHZtLnNlYXJjaFRleHQpXCIgbWQtaXRlbS10ZXh0PVwiaXRlbS5uYW1lXCIgbWQtbWluLWxlbmd0aD1cIjBcIiBwbGFjZWhvbGRlcj1cIlNlYXJjaCBQZW9wbGVcIiBjbGFzcz1cImF1dG8tY29tcGxldGUtY3VzdG9tXCI+IDxtZC1pdGVtLXRlbXBsYXRlPiA8c3BhbiBtZC1oaWdobGlnaHQtdGV4dD1cImN0cmwuc2VhcmNoVGV4dFwiIG1kLWhpZ2hsaWdodC1mbGFncz1cIl5pXCI+e3tpdGVtLm5hbWV9fTwvc3Bhbj4gPC9tZC1pdGVtLXRlbXBsYXRlPiA8bWQtbm90LWZvdW5kPiBObyBzdGF0ZXMgbWF0Y2hpbmcgXCJ7e2N0cmwuc2VhcmNoVGV4dH19XCIgd2VyZSBmb3VuZC4gPGEgbmctY2xpY2s9XCJjdHJsLm5ld1N0YXRlKGN0cmwuc2VhcmNoVGV4dClcIj5DcmVhdGUgYSBuZXcgb25lITwvYT4gPC9tZC1ub3QtZm91bmQ+IDwvbWQtYXV0b2NvbXBsZXRlPiA8L2Rpdj48ZGl2IGZsZXggY2xhc3M9XCJidG4tc2VhcmNoLWhvbGRlclwiPjxidXR0b24gY2xhc3M9XCJidG4tc2VhcmNoXCIgdHlwZT1cImJ1dHRvblwiPjxpIGNsYXNzPVwiZmEgZmEtc2VhcmNoXCI+PC9pPiA8L2J1dHRvbj48L2Rpdj48L2Rpdj4nLFxuICAgICAgICAgICAgLy8gdGVtcGxhdGU6JzxkaXYgbGF5b3V0LWFsaWduPVwic3RhcnQgY2VudGVyXCIgbGF5b3V0PVwicm93XCIgbGF5b3V0LWZpbGw+IDxkaXYgZmxleC1vZmZzZXQ9XCI1XCIgZmxleD1cIjYwXCI+IDxkaXYgY2xhc3M9XCJzZWFyY2gtZ3JvdXAgYWN0aXZlXCI+IDxkaXY+IDxpbnB1dCBpZD1cInNlYXJjaF90eHRcIiBuYW1lPVwic2VhcmNoX3R4dFwiIHR5cGU9XCJ0ZXh0XCIgb25rZXl1cD1cInZpZXdFbXBsb3llZSgxKTtcIiBwbGFjZWhvbGRlcj1cIlNlYXJjaFwiPiA8YnV0dG9uIGNsYXNzPVwiYnRuLXNlYXJjaFwiIHR5cGU9XCJidXR0b25cIiBvbmNsaWNrPVwidmlld0VtcGxveWVlKDEpO1wiPjwvYnV0dG9uPiA8L2Rpdj48YSBjbGFzcz1cImFkdmFjZVwiIGhyZWY9XCIjXCI+QWR2YW5jZTwvYT4gPC9kaXY+IDwvZGl2PjwvZGl2PicsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICBzY29wZToge30sXG4gICAgICAgICAgICBiaW5kVG9Db250cm9sbGVyOiB7XG4gICAgICAgICAgICAgICAgc2VhcmNoYWJsZUxpc3Q6Jz0nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGluazogbGlua1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XG4gICAgICAgIGZ1bmN0aW9uIGxpbmsoKSB7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIC8qQG5nSW5qZWN0Ki9cbiAgICAgICAgZnVuY3Rpb24gQ2FzY2FkZVRyZWVTZWFyY2hCb3hDb250cm9sbGVyKHRyZWVWaWV3U2VydmljZSkge1xuXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICAgICAgdm0uc2ltdWxhdGVRdWVyeSA9IGZhbHNlO1xuICAgICAgICAgICAgdm0uaXNEaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdm0ubm9DYWNoZSA9IHRydWU7XG5cbiAgICAgICAgICAgIC8vIGxpc3Qgb2YgYHN0YXRlYCB2YWx1ZS9kaXNwbGF5IG9iamVjdHNcbiAgICAgICAgICAgIHZtLnF1ZXJ5U2VhcmNoID0gcXVlcnlTZWFyY2g7XG4gICAgICAgICAgICB2bS5zZWxlY3RlZEl0ZW1DaGFuZ2UgPSBzZWxlY3RlZEl0ZW1DaGFuZ2U7XG4gICAgICAgICAgICB2bS5zZWFyY2hUZXh0Q2hhbmdlID0gc2VhcmNoVGV4dENoYW5nZTtcblxuICAgICAgICAgICAgdm0ubmV3U3RhdGUgPSBuZXdTdGF0ZTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gbmV3U3RhdGUoc3RhdGUpIHtcbiAgICAgICAgICAgICAgICBhbGVydChcIlNvcnJ5ISBZb3UnbGwgbmVlZCB0byBjcmVhdGUgYSBDb25zdGl0dXRpb24gZm9yIFwiICsgc3RhdGUgKyBcIiBmaXJzdCFcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgICAgLy8gSW50ZXJuYWwgbWV0aG9kc1xuICAgICAgICAgICAgLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2VhcmNoIGZvciBzdGF0ZXMuLi4gdXNlICR0aW1lb3V0IHRvIHNpbXVsYXRlXG4gICAgICAgICAgICAgKiByZW1vdGUgZGF0YXNlcnZpY2UgY2FsbC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gcXVlcnlTZWFyY2gocXVlcnkpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh2bS5zZWFyY2hhYmxlTGlzdCk7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSBxdWVyeSA/IHZtLnNlYXJjaGFibGVMaXN0LmZpbHRlcihjcmVhdGVGaWx0ZXJGb3IocXVlcnkpKSA6IHZtLnNlYXJjaGFibGVMaXN0LFxuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZDtcbiAgICAgICAgICAgICAgICBpZiAodm0uc2ltdWxhdGVRdWVyeSkge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgICAgIH0sIE1hdGgucmFuZG9tKCkgKiAxMDAwLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gc2VhcmNoVGV4dENoYW5nZSh0ZXh0KSB7XG4gICAgICAgICAgICAgICAgJGxvZy5pbmZvKCdUZXh0IGNoYW5nZWQgdG8gJyArIHRleHQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBzZWxlY3RlZEl0ZW1DaGFuZ2UoaXRlbSkge1xuXG4gICAgICAgICAgICAgICAgaWYoaXRlbSl7XG4gICAgICAgICAgICAgICAgICAgICRsb2cuaW5mbygnSXRlbSBjaGFuZ2VkIHRvICcgKyBKU09OLnN0cmluZ2lmeShpdGVtKSk7XG4gICAgICAgICAgICAgICAgICAgIHRyZWVWaWV3U2VydmljZS5zZXRTZWFyY2hlZE5vZGUoaXRlbSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cblxuXG4gICAgICAgICAgICBmdW5jdGlvbiBleHRyYWN0Tm9kZXMobGlzdE9mTm9kZXMpIHtcblxuICAgICAgICAgICAgICAgIHJldHVybiBsaXN0T2ZOb2Rlcy5tYXAoZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBub2RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogbm9kZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheUxvd2VyQ2FzZTogbm9kZS5uYW1lLnRvTG93ZXJDYXNlKClcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDcmVhdGUgZmlsdGVyIGZ1bmN0aW9uIGZvciBhIHF1ZXJ5IHN0cmluZ1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBjcmVhdGVGaWx0ZXJGb3IocXVlcnkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbG93ZXJjYXNlUXVlcnkgPSBhbmd1bGFyLmxvd2VyY2FzZShxdWVyeSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gZmlsdGVyRm4oc3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChzdGF0ZS5uYW1lLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihsb3dlcmNhc2VRdWVyeSkgPT09IDApO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfVxuXG5cbn0pKCk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdXNlciBvbiA2LzUvMTcuXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ29yZ0NoYXJ0JykuZGlyZWN0aXZlKCd0cmVlVG9vbFNldCcsIHRyZWVUb29sU2V0KTtcblxuICAgIC8qQG5nSW5qZWN0Ki9cbiAgICBmdW5jdGlvbiB0cmVlVG9vbFNldCgpIHtcblxuICAgICAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgICAgICAgcmVwbGFjZTogZmFsc2UsXG4gICAgICAgICAgICByZXN0cmljdDogJ0VBJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFRyZWVUb29sU2V0LFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgLy8gdGVtcGxhdGVVcmw6ICd0b29sc2V0LnRtcGwuaHRtbCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgbGF5b3V0PVwiY29sdW1uXCIgbGF5b3V0LWFsaWduPVwiY2VudGVyIGVuZFwiPicgK1xuICAgICAgICAgICAgJyA8ZGl2IGxheW91dD1cImNvbHVtblwiIGxheW91dC1hbGlnbj1cInNwYWNlLWFyb3VuZCBjZW50ZXJcIiBjbGFzcz1cInRvb2xzZXQtd3JhcHBlclwiIGZsZXgtb2Zmc2V0PVwiNVwiPicgK1xuICAgICAgICAgICAgJyA8ZGl2PiA8YnV0dG9uIGNsYXNzPVwidG9vbHNldC1idG4gdXBwZXItcm91bmRlZFwiIG5nLWNsaWNrPVwidm0uem9vbVRyaWdnZXIoXFwnaW5jcmVtZW50XFwnKVwiPiA8bWQtdG9vbHRpcCBtZC1kaXJlY3Rpb249XCJib3R0b21cIj5ab29tIEluPC9tZC10b29sdGlwPiA8bWQtaWNvbj48aSBuZy1jbGFzcz1cIntcXCdmYSBmYS1wbHVzXFwnOnRydWUsXFwnY3VzdG9tLWZvbnQtaWNvblxcJzp0cnVlfVwiPjwvaT48L21kLWljb24+PC9idXR0b24+IDwvZGl2PicgK1xuICAgICAgICAgICAgJzxkaXY+IDxidXR0b24gY2xhc3M9XCJ0b29sc2V0LWJ0biBsb3dlci1yb3VuZGVkXCIgbmctY2xpY2s9XCJ2bS56b29tVHJpZ2dlcihcXCdkZWNyZW1lbnRcXCcpXCI+IDxtZC10b29sdGlwIG1kLWRpcmVjdGlvbj1cImJvdHRvbVwiPlpvb20gT3V0PC9tZC10b29sdGlwPiA8bWQtaWNvbj48aSBuZy1jbGFzcz1cIntcXCdmYSBmYS1taW51c1xcJzp0cnVlLFxcJ2N1c3RvbS1mb250LWljb25cXCc6dHJ1ZX1cIj48L2k+PC9tZC1pY29uPjwvYnV0dG9uPiA8L2Rpdj4nICtcbiAgICAgICAgICAgICc8ZGl2IHN0eWxlPVwibWFyZ2luLXRvcDogMTBweFwiPiA8YnV0dG9uIGNsYXNzPVwidG9vbHNldC1idG5cIiBuZy1jbGljaz1cInZtLnRvZ2dsZUV4cGFuZEFsbE1vZGUoKVwiPiA8bWQtdG9vbHRpcCBtZC1kaXJlY3Rpb249XCJib3R0b21cIj48c3BhbiBuZy1pZj1cIiF2bS5pc0V4cGFuZEFsbE1vZGVcIj5FeHBhbmQgQWxsPC9zcGFuPjxzcGFuIG5nLWlmPVwidm0uaXNFeHBhbmRBbGxNb2RlXCI+Q29sbGFwc2UgQWxsPC9zcGFuPjwvbWQtdG9vbHRpcD4gPG1kLWljb24+PGkgbmctY2xhc3M9XCJ7XFwnZmEgZmEtZXhwYW5kXFwnOiF2bS5pc0V4cGFuZEFsbE1vZGUsXFwnZmEgZmEtY29tcHJlc3NcXCc6dm0uaXNFeHBhbmRBbGxNb2RlLFxcJ2N1c3RvbS1mb250LWljb25cXCc6dHJ1ZX1cIj48L2k+IDwvbWQtaWNvbj48L2J1dHRvbj4gPC9kaXY+JyArXG4gICAgICAgICAgICAnPC9kaXY+PC9kaXY+JyxcbiAgICAgICAgICAgIHNjb3BlOiB7fSxcbiAgICAgICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHtcbiAgICAgICAgICAgICAgICB6b29tVHJpZ2dlckNhbGxCYWNrOiAnJidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsaW5rOiBsaW5rXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgICAgICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtLCBhdHRyLCB2bSkge1xuXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKkBuZ0luamVjdCovXG4gICAgZnVuY3Rpb24gVHJlZVRvb2xTZXQodG9vbFNldFNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICB2bS5pc0V4cGFuZEFsbE1vZGUgPSB0b29sU2V0U2VydmljZS5pc0V4cGFuZEFsbE1vZGUoKTtcbiAgICAgICAgdm0udG9nZ2xlRXhwYW5kQWxsTW9kZSA9IHRvZ2dsZUV4cGFuZEFsbE1vZGU7XG4gICAgICAgIHZtLnpvb21UcmlnZ2VyID0gem9vbVRyaWdnZXI7XG4vKiAgICAgICAgdm0uaW5jcmVtZW50Wm9vbVNjYWxlID0gaW5jcmVtZW50Wm9vbVNjYWxlO1xuICAgICAgICB2bS5kZWNyZW1lbnRab29tU2NhbGUgPSBkZWNyZW1lbnRab29tU2NhbGU7Ki9cbiAgICAgICAgdm0uem9vbVNjYWxlID0gdG9vbFNldFNlcnZpY2UuZ2V0Wm9vbVNjYWxlKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gdG9nZ2xlRXhwYW5kQWxsTW9kZSgpIHtcbiAgICAgICAgICAgIHZtLmlzRXhwYW5kQWxsTW9kZSA9IHRvb2xTZXRTZXJ2aWNlLnRvZ2dsZUV4cGFuZEFsbE1vZGUoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBmdW5jdGlvbiB6b29tVHJpZ2dlcihzdGF0dXMpIHtcbiAgICAgICAgICAgIHZtLnpvb21UcmlnZ2VyQ2FsbEJhY2soe3N0YXR1czpzdGF0dXN9KTtcbiAgICAgICAgfVxuXG4vKiAgICAgICAgZnVuY3Rpb24gaW5jcmVtZW50Wm9vbVNjYWxlKCkge1xuICAgICAgICAgICAgdm0uem9vbVNjYWxlID0gdG9vbFNldFNlcnZpY2UuaW5jcmVtZW50Wm9vbVNjYWxlKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkZWNyZW1lbnRab29tU2NhbGUoKSB7XG4gICAgICAgICAgICB2bS56b29tU2NhbGUgPSB0b29sU2V0U2VydmljZS5kZWNyZW1lbnRab29tU2NhbGUoKTtcbiAgICAgICAgfSovXG4gICAgfVxuXG59KSgpO1xuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHVzZXIgb24gNi81LzE3LlxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdvcmdDaGFydCcpLmZhY3RvcnkoJ3Rvb2xTZXRTZXJ2aWNlJywgdG9vbFNldFNlcnZpY2UpO1xuXG4gICAgLypAbmdJbmplY3QqL1xuICAgIGZ1bmN0aW9uIHRvb2xTZXRTZXJ2aWNlKCkge1xuXG4gICAgICAgIHZhciBpc0FsbEV4cGFuZGVkTW9kZSA9IGZhbHNlO1xuICAgICAgICB2YXIgTE9XRVNUX1pPT01fU0NBTEUgPSAwLjM7XG4gICAgICAgIHZhciBERUZBVUxUX1pPT01fU0NBTEUgPSAxO1xuICAgICAgICB2YXIgem9vbVNjYWxlID0gREVGQVVMVF9aT09NX1NDQUxFO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpc0V4cGFuZEFsbE1vZGU6IGlzRXhwYW5kQWxsTW9kZSxcbiAgICAgICAgICAgIHRvZ2dsZUV4cGFuZEFsbE1vZGU6IHRvZ2dsZUV4cGFuZEFsbE1vZGUsXG4gICAgICAgICAgICBnZXRab29tU2NhbGU6IGdldFpvb21TY2FsZSxcbiAgICAgICAgICAgIHNldFpvb21TY2FsZTogc2V0Wm9vbVNjYWxlLFxuICAgICAgICAgICAgaW5jcmVtZW50Wm9vbVNjYWxlOiBpbmNyZW1lbnRab29tU2NhbGUsXG4gICAgICAgICAgICBkZWNyZW1lbnRab29tU2NhbGU6IGRlY3JlbWVudFpvb21TY2FsZVxuICAgICAgICB9O1xuXG4gICAgICAgIGZ1bmN0aW9uIGlzRXhwYW5kQWxsTW9kZSgpIHtcbiAgICAgICAgICAgIHJldHVybiBpc0FsbEV4cGFuZGVkTW9kZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHRvZ2dsZUV4cGFuZEFsbE1vZGUoKSB7XG4gICAgICAgICAgICBpc0FsbEV4cGFuZGVkTW9kZSA9ICFpc0FsbEV4cGFuZGVkTW9kZTtcbiAgICAgICAgICAgIHJldHVybiBpc0FsbEV4cGFuZGVkTW9kZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFpvb21TY2FsZSgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnZXRab29tIFNjYWxlJyx6b29tU2NhbGUpO1xuICAgICAgICAgICAgcmV0dXJuIHpvb21TY2FsZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldFpvb21TY2FsZShzY2FsZSkge1xuICAgICAgICAgICAgaWYgKHNjYWxlID4gMSkge1xuICAgICAgICAgICAgICAgIC8vIHpvb21TY2FsZSA9IHNjYWxlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyB6b29tU2NhbGUgPSBMT1dFU1RfWk9PTV9TQ0FMRSArIHNjYWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgem9vbVNjYWxlID0gc2NhbGU7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnem9vbSBzY2FsZScsIHpvb21TY2FsZSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpbmNyZW1lbnRab29tU2NhbGUoKSB7XG4gICAgICAgICAgICB6b29tU2NhbGUgKz0gMC4xO1xuXG4gICAgICAgICAgICByZXR1cm4gem9vbVNjYWxlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZGVjcmVtZW50Wm9vbVNjYWxlKCkge1xuICAgICAgICAgICAgaWYgKHpvb21TY2FsZSA+IC0yLjUpIHtcbiAgICAgICAgICAgICAgICB6b29tU2NhbGUgLT0gMC4xO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gem9vbVNjYWxlO1xuICAgICAgICB9XG4gICAgfVxufSkoKTtcbiIsIi8qKlxuICogQ3JlYXRlZCBieSB1c2VyIG9uIDUvMzEvMTcuXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIGFuZ3VsYXIubW9kdWxlKCdvcmdDaGFydCcpLmRpcmVjdGl2ZSgndHJlZU5vZGUnLCB0cmVlTm9kZSk7XG5cbiAgICAvKkBuZ0luamVjdCovXG4gICAgZnVuY3Rpb24gdHJlZU5vZGUodHJlZVZpZXdTZXJ2aWNlLCAkdGltZW91dCwgJGRvY3VtZW50LCRyb290U2NvcGUpIHtcblxuICAgICAgICB2YXIgY2FzY2FkZVRyZWVOb2RlRGlyZWN0aXZlID0ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHJlcGxhY2U6IGZhbHNlLFxuICAgICAgICAgICAgLy8gcmVxdWlyZTonXmNhc2NhZGVUcmVlVmlldycsXG4gICAgICAgICAgICBjb250cm9sbGVyOiBDYXNjYWRlVHJlZU5vZGVDb250cm9sbGVyLFxuICAgICAgICAgICAgLy8gdGVtcGxhdGVVcmw6ICdhcHAvY2FzY2FkZS90ZXN0L29yZ2NoYXJ0L2RpcmVjdGl2ZXMvdHJlZW5vZGUudG1wbC5odG1sJyxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiBuZy1jbGFzcz1cIntcXCdhY3RpdmUtbm9kZVxcJzp2bS5pc0FjdGl2ZX1cIiBjbGFzcz1cInt7dm0ubm9kZUNsYXNzfX1cIiBuZy1tb3VzZWVudGVyPVwidm0ud2hlbk1vdXNlRW50ZXIoKVwiIG5nLW1vdXNlbGVhdmU9XCJ2bS53aGVuTW91c2VMZWF2ZSgpXCIgbmctY2xpY2s9XCJ2bS5tYWtlTm9kZUFjdGl2ZSgpXCI+IDxkaXYgbGF5b3V0PVwiY29sdW1uXCIgbGF5b3V0LWFsaWduPVwiY2VudGVyIGNlbnRlclwiPiA8ZGl2IG5nLWNsYXNzPVwie1xcJ25vZGUtdGV4dC1tYWluLW5vLWltYWdlXFwnOiF2bS5pc0ltYWdlUHJlc2VudH1cIiBjbGFzcz1cIm1kLXN1YmhlYWQgbm9kZS10ZXh0LW1haW5cIj48dHJpbS13b3JkIHdvcmQtb3B0aW9ucyA9XCJ2bS53b3JkVHJpbU9wdGlvbnNcIiB3b3JkPVwidm0ubm9kZS5uYW1lXCI+PC90cmltLXdvcmQ+PC9kaXY+PGRpdj4gPGRpdiBjbGFzcz1cInJvdW5kLWNoaXAtd3JhcHBlclwiPjxpbWcgbmctaWY9XCJ2bS5pc0ltYWdlUHJlc2VudFwiIG5nLXNyYz1cInt7dm0ubm9kZS5pbWFnZV91cmx9fVwiIGNsYXNzPVwicm91bmQtY2hpcFwiPiA8L2Rpdj48L2Rpdj48ZGl2ICBuZy1jbGFzcz1cIntcXCdub2RlLXRleHQtc3ViLW5vLWltYWdlXFwnOiF2bS5pc0ltYWdlUHJlc2VudH1cIiBjbGFzcz1cIm1kLXN1YmhlYWQgbm9kZS10ZXh0LXN1YlwiPnt7dm0ubm9kZS5uYW1lfX08L2Rpdj48ZGl2IGxheW91dC1hbGlnbj1cImNlbnRlciBjZW50ZXJcIiBsYXlvdXQtZmlsbCBsYXlvdXQ9XCJyb3dcIj4gPGRpdiBuZy1yZXBlYXQ9XCJhY3Rpb24gaW4gdm0ubm9kZUFjdGlvbnNcIj4gPGJ1dHRvbiBuZy1jbGljaz1cInZtLm1ha2VDYWxsQmFjayhhY3Rpb24uY2FsbEJhY2spOyAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XCIgY2xhc3M9XCJhY3Rpb24tYnRuXCI+PHNwYW4+PC9zcGFuPiZuYnNwOzxpIGNsYXNzPVwie3thY3Rpb24uaWNvbn19XCI+PC9pPjwvYnV0dG9uPiA8L2Rpdj48L2Rpdj48L2Rpdj48L2Rpdj4nLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgc2NvcGU6IHt9LFxuICAgICAgICAgICAgYmluZFRvQ29udHJvbGxlcjoge1xuICAgICAgICAgICAgICAgIG5vZGVJZDogJ0AnLFxuICAgICAgICAgICAgICAgIG5vZGVBY3Rpb25zOiAnQCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsaW5rOiB7XG4gICAgICAgICAgICAgICAgcHJlOmxpbmtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gY2FzY2FkZVRyZWVOb2RlRGlyZWN0aXZlO1xuXG5cbiAgICAgICAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbSwgYXR0cnMsIHZtKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhhdHRycy5pbWFnZXByZXNlbnQpO1xuICAgICAgICAgICAgdm0uaXNJbWFnZVByZXNlbnQgPSBhdHRycy5pbWFnZXByZXNlbnQ9PSd0cnVlJz90cnVlOmZhbHNlO1xuICAgICAgICAgICAgdm0uaWQgPSBhdHRycy5ub2RlaWQ7XG4gICAgICAgICAgICB2bS5ub2RlQWN0aW9ucyA9IGFuZ3VsYXIuZnJvbUpzb24oYXR0cnMubm9kZWFjdGlvbnMpO1xuICAgICAgICAgICAgY29uc29sZS5sb2codm0ubm9kZUFjdGlvbnMpO1xuICAgICAgICAgICAgdm0uaXNQaW5uZWROb2RlID0gZmFsc2U7XG4gICAgICAgICAgICB2bS5ub2RlID0gdHJlZVZpZXdTZXJ2aWNlLmZpbmRCeUlkKGF0dHJzLm5vZGVpZCk7XG4gICAgICAgICAgICB2bS53b3JkVHJpbU9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgd29yZDogJ2QnLFxuICAgICAgICAgICAgICAgIGZyb206ICcwJyxcbiAgICAgICAgICAgICAgICB1bnRpbDogJzEyJyxcbiAgICAgICAgICAgICAgICB0b29sVGlwOiAndHJ1ZScsXG4gICAgICAgICAgICAgICAgdG9vbFRpcERpcmVjdGlvbjogJ3RvcCdcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8qY29uc29sZS5sb2coYW5ndWxhci5mcm9tSnNvbihhdHRycy5ub2RlKSk7XG4gICAgICAgICAgICB2bS5ub2RlID0gYW5ndWxhci5mcm9tSnNvbihhdHRycy5ub2RlKTsqL1xuICAgICAgICAgICAgdm0ubm9kZUNsYXNzID0gJ25vZGUtbGFiZWwgbm9kZS0nICsgdm0ubm9kZS50eXBlKyAnIG5vZGUtJyt2bS5pZDtcblxuICAgICAgICAgICAgLy8gdm0uaXNQaW5uZWROb2RlID0gdHJ1ZTtcbiAgICAgICAgICAgIHZtLmlzRXhwYW5kZWRWaWV3ID0gZmFsc2U7XG4gICAgICAgICAgICB2bS5pc0FjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICB2bS53aGVuTW91c2VFbnRlciA9IHdoZW5Nb3VzZUVudGVyO1xuICAgICAgICAgICAgdm0ud2hlbk1vdXNlTGVhdmUgPSB3aGVuTW91c2VMZWF2ZTtcbiAgICAgICAgICAgIHZtLnRvZ2dsZVBpbm5lZE1vZGUgPSB0b2dnbGVQaW5uZWRNb2RlO1xuICAgICAgICAgICAgdm0ubWFrZUNhbGxCYWNrID0gbWFrZUNhbGxCYWNrO1xuICAgICAgICAgICAgdm0ubWFrZU5vZGVBY3RpdmUgPSBtYWtlTm9kZUFjdGl2ZTtcbiAgICAgICAgICAgIHZhciBub2RlRE9NRWxlbWVudCA9IGFuZ3VsYXIuZWxlbWVudChlbGVtLmNoaWxkcmVuKClbMF0pO1xuICAgICAgICAgICAgLyogICAgICAgICAgICBlbGVtLm9uKCdjbGljaycsZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICBlbGVtLmFkZENsYXNzKCdhY3RpdmUtbm9kZScpO1xuICAgICAgICAgICAgIH0pOyovXG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIG1ha2VOb2RlQWN0aXZlKCkge1xuICAgICAgICAgICAgICAgIGNsZWFyQWxsT3RoZXJBY3RpdmVOb2RlcygpO1xuICAgICAgICAgICAgICAgIHZtLmlzQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gd2hlbk1vdXNlRW50ZXIoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ21vdXNlIEVudGVyZWQnKTtcbiAgICAgICAgICAgICAgICAvLyB2bS5pc0V4cGFuZGVkVmlldyA9IHRydWU7XG4gICAgICAgICAgICAgICAgLy8gdm0uaXNQaW5uZWROb2RlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gd2hlbk1vdXNlTGVhdmUoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ21vdXNlIGxlYXZlZCcpO1xuICAgICAgICAgICAgICAgIC8vIHZtLmlzRXhwYW5kZWRWaWV3ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgLyogICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICB2bS5pc1Bpbm5lZE5vZGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgfSwxMDAwKTsqL1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiB0b2dnbGVQaW5uZWRNb2RlKCkge1xuICAgICAgICAgICAgICAgIHZtLmlzUGlubmVkTm9kZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codm0uaXNQaW5uZWROb2RlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gbWFrZUNhbGxCYWNrKGNhbGxCYWNrRnVuY05hbWUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhjYWxsQmFja0Z1bmNOYW1lKTtcbiAgICAgICAgICAgICAgICBzY29wZS4kcGFyZW50LnZtLm1ha2VDYWxsQmFjayhjYWxsQmFja0Z1bmNOYW1lLHZtLm5vZGUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjbGVhckFsbE90aGVyQWN0aXZlTm9kZXMoKXtcbi8qICAgICAgICAgICAgICAgIGVsZW0uZmluZCgnLm5vZGUtbGFiZWwnKTsvL1RPRE9cbiAgICAgICAgICAgICAgICBlbGVtLnBhcmVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdhY3RpdmUtbm9kZScpOyovXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdhcHA6bm9kZXM6Y2xlYXJhY3RpdmUnLHsnZGF0YSc6ICcnfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGZpbmRSZWxldmFudE5vZGUoa2xhc3Mpe1xuICAgICAgICAgICAgICAgIGVsZW0uZmluZCgnLnRyZWUtaG9sZGVyJyk7Ly9UT0RPXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmdW5jdGlvbiBvbkRvY3VtZW50Q2xpY2soZXYpIHtcblxuICAgICAgICAgICAgICAgIC8vQ2hlY2sgaWYgY2xpY2tlZCBvdXRzaWRlIGFuZCBkaXNjYXJkIEFjdGl2ZVxuICAgICAgICAgICAgICAgIGlmIChlbGVtICE9PSBldi50YXJnZXQgJiYgIWVsZW1bMF0uY29udGFpbnMoZXYudGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdm0uaXNBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL3JlbW92ZSBldmVudCBoYW5kbGVycyB3aGVuIGN1c3RvbSBkaXJlY3RpdmUgZGVzdHJveWVkXG4gICAgICAgICAgICBmdW5jdGlvbiBvbkRlc3Ryb3koKSB7XG4gICAgICAgICAgICAgICAgJGRvY3VtZW50Lm9mZignY2xpY2snLCBvbkRvY3VtZW50Q2xpY2spO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICRkb2N1bWVudC5vbignY2xpY2snLCBvbkRvY3VtZW50Q2xpY2spO1xuICAgICAgICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIG9uRGVzdHJveSk7XG5cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qQG5nSW5qZWN0Ki9cbiAgICBmdW5jdGlvbiBDYXNjYWRlVHJlZU5vZGVDb250cm9sbGVyKHRyZWVWaWV3U2VydmljZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICAvKiAgICAgICAgdm0ubm9kZSA9IHRyZWVWaWV3U2VydmljZS5maW5kQnlJZCh2bS5ub2RlSWQpO1xuICAgICAgICAgdm0ubm9kZUNsYXNzID0gJ25vZGUtbGFiZWwgbm9kZS0nK3ZtLm5vZGUudHlwZTsqL1xuXG4gICAgfVxufSkoKTtcbiIsIi8qKlxuICogQ3JlYXRlZCBieSBHYXlhbiBQcmFzYW5uYSBvbiA1LzMwLzE3LlxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICBhbmd1bGFyLm1vZHVsZSgnb3JnQ2hhcnQnKS5kaXJlY3RpdmUoJ3RyZWVWaWV3JywgdHJlZVZpZXcpO1xuXG4gICAgLypAbmdJbmplY3QqL1xuICAgIGZ1bmN0aW9uIHRyZWVWaWV3KCRmaWx0ZXIsICRjb21waWxlLCB0cmVlVmlld1NlcnZpY2UsICR0aW1lb3V0LCB0b29sU2V0U2VydmljZSwgJHdpbmRvdykge1xuICAgICAgICB2YXIgdHJlZVZpZXdEaXJlY3RpdmUgPSB7XG4gICAgICAgICAgICByZXBsYWNlOiAnZmFsc2UnLFxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHNjb3BlOiB7fSxcbiAgICAgICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHtcbiAgICAgICAgICAgICAgICBkYXRhOiAnPScsXG4gICAgICAgICAgICAgICAgYWJuOiAnJicsXG4gICAgICAgICAgICAgICAgZGVsOiAnJicsXG4gICAgICAgICAgICAgICAgYWRkOiAnJicsXG4gICAgICAgICAgICAgICAgZWRpdDogJyYnLFxuICAgICAgICAgICAgICAgIG5vZGVBY3Rpb25zOiAnQCcsXG4gICAgICAgICAgICAgICAgdHJlZWRhdGE6ICc9JyxcbiAgICAgICAgICAgICAgICBzZWFyY2hhYmxlTGlzdDogJz0nLFxuICAgICAgICAgICAgICAgIGltYWdlcHJlc2VudDogJz0nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY29udHJvbGxlcjogVHJlZVZpZXdEaXJlY3RpdmVDb250cm9sbGVyLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgbGluazoge1xuICAgICAgICAgICAgICAgIHByZTogbGlua1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW0sIGF0dHJzLCB2bSkge1xuXG4gICAgICAgICAgICB2YXIgbm9kZUJvdW5kYXJpZXMgPSB7XG4gICAgICAgICAgICAgICAgd2lkdGg6IDI0MCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDE0NixcbiAgICAgICAgICAgICAgICBob3Jpem9udGFsU2VwZXJhdGlvbjogMTYsXG4gICAgICAgICAgICAgICAgdmVydGljYWxTZXBlcmF0aW9uOiAxMjhcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgZHJhZ1N0YXJ0ZWQ9ZmFsc2U7XG4gICAgICAgICAgICB2YXIgbm9kZXM7XG4gICAgICAgICAgICB2YXIgZG9tTm9kZTtcbiAgICAgICAgICAgIHZhciByZWxDb29yZHM7XG4gICAgICAgICAgICB2YXIgcGFuVGltZXI7XG4gICAgICAgICAgICAvLyB2YXJpYWJsZXMgZm9yIGRyYWcvZHJvcFxuICAgICAgICAgICAgdmFyIHNlbGVjdGVkTm9kZSA9IG51bGw7XG4gICAgICAgICAgICB2YXIgZHJhZ2dpbmdOb2RlID0gbnVsbDtcbiAgICAgICAgICAgIC8vIHBhbm5pbmcgdmFyaWFibGVzXG4gICAgICAgICAgICB2YXIgcGFuU3BlZWQgPSAyMDA7XG4gICAgICAgICAgICB2YXIgcGFuQm91bmRhcnkgPSAyMDsgLy8gV2l0aGluIDIwcHggZnJvbSBlZGdlcyB3aWxsIHBhbiB3aGVuIGRyYWdnaW5nLlxuICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZUNvb3JkcztcbiAgICAgICAgICAgIHZhciBsaW5rcztcbiAgICAgICAgICAgIHZhciBub2RlUGF0aHM7XG4gICAgICAgICAgICB2YXIgbm9kZXNFeGl0O1xuICAgICAgICAgICAgdmFyIHBhcmVudExpbms7XG5cbiAgICAgICAgICAgIHZhciBub2RlQWN0aXZlQ2xlYXJMaXN0ZW5lcjtcbiAgICAgICAgICAgIHZhciBub2RlRGVsZXRlTGlzdGVuZXI7XG4gICAgICAgICAgICB2YXIgbm9kZUFmdGVyQWRkTGlzdGVuZXI7XG4gICAgICAgICAgICB2YXIgbm9kZUFmdGVyVXBkYXRlTGlzdGVuZXI7XG4gICAgICAgICAgICB2YXIgZHJhZ0xpc3RlbmVyO1xuICAgICAgICAgICAgdmFyIG5vZGVMaXN0ID0gW107XG4gICAgICAgICAgICB2YXIgbSA9IFsyMCwgMjAsIDIwLCAyMF0sXG4gICAgICAgICAgICAgICAgdyA9ICR3aW5kb3cuaW5uZXJXaWR0aCAtIDIwIC0gbVsxXSAtIG1bM10sXG4gICAgICAgICAgICAgICAgaUhlaWdodCA9ICR3aW5kb3cuaW5uZXJIZWlnaHQsXG4gICAgICAgICAgICAgICAgaCA9IDYwMCAtIG1bMF0gLSBtWzJdLFxuICAgICAgICAgICAgICAgIGkgPSAwLFxuICAgICAgICAgICAgICAgIHIgPSA4MDAsXG4gICAgICAgICAgICAgICAgeCA9IGQzLnNjYWxlLmxpbmVhcigpLmRvbWFpbihbMCwgd10pLnJhbmdlKFswLCB3XSksXG4gICAgICAgICAgICAgICAgeSA9IGQzLnNjYWxlLmxpbmVhcigpLmRvbWFpbihbMCwgaF0pLnJhbmdlKFswLCBoXSksXG4gICAgICAgICAgICAgICAgcm9vdDtcbiAgICAgICAgICAgIHZhciB2aWV3Qm94Qm91bmRhcnkgPSAnMCAwICcgKyB3ICsgXCIgXCIgKyBpSGVpZ2h0O1xuICAgICAgICAgICAgdmFyIHdyYXBwZXJFbGVtZW50ID0gZDMuc2VsZWN0KGVsZW1bMF0pO1xuICAgICAgICAgICAgdmFyIGxhc3RTZWFyY2hlZFBhdGggPSBbXTtcblxuICAgICAgICAgICAgdmFyIHpvb20gPSBkMy5iZWhhdmlvci56b29tKClcbiAgICAgICAgICAgICAgICAudHJhbnNsYXRlKFswLCAwXSlcbiAgICAgICAgICAgICAgICAuc2NhbGUodG9vbFNldFNlcnZpY2UuZ2V0Wm9vbVNjYWxlKCkpXG4gICAgICAgICAgICAgICAgLnNjYWxlRXh0ZW50KFswLjMsIDhdKVxuICAgICAgICAgICAgICAgIC5vbihcInpvb21cIiwgem9vbWVkKTtcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgem9vbU9iamVjdCA9IGQzLmJlaGF2aW9yLnpvb20oKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50cmFuc2xhdGUoWzAsIDBdKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zY2FsZSh0b29sU2V0U2VydmljZS5nZXRab29tU2NhbGUoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2NhbGVFeHRlbnQoWzAuMywgOF0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9uKFwiem9vbVwiLCB6b29tZWRXcmFwcGVyKTsqL1xuXG4gICAgICAgICAgICAvLyB6b29tKCk7XG4gICAgICAgICAgICBlbGVtLmFwcGVuZCgkY29tcGlsZShcIjxkaXYgY2xhc3M9J2NvbXBvbmVudC1jb250YWluZXInPjxkaXYgbGF5b3V0PVxcXCJyb3dcXFwiIGxheW91dC1hbGlnbj1cXFwic3BhY2UtYXJvdW5kIGNlbnRlclxcXCI+PGRpdiBmbGV4Pjx0cmVlLXNlYXJjaC1ib3ggc2VhcmNoYWJsZS1saXN0PSd2bS5zZWFyY2hhYmxlTGlzdCc+PC90cmVlLXNlYXJjaC1ib3g+PC9kaXY+PGRpdiBmbGV4Pjx0cmVlLXRvb2wtc2V0IHpvb20tdHJpZ2dlci1jYWxsLWJhY2s9J3ZtLnpvb21UcmlnZ2VyKHN0YXR1cyknPjwvdHJlZS10b29sLXNldD48L2Rpdj48L2Rpdj48L2Rpdj5cIikoc2NvcGUpKTtcblxuICAgICAgICAgICAgdm0uem9vbVRyaWdnZXIgPSB6b29tVHJpZ2dlcjtcblxuXG4gICAgICAgICAgICBmdW5jdGlvbiB6b29tVHJpZ2dlcihzdGF0dXMpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzdGF0dXMpO1xuICAgICAgICAgICAgICAgIHpvb21DbGljayhzdGF0dXMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBvbkluaXQoKSB7XG4gICAgICAgICAgICAgICAgYWN0aXZhdGVXYXRjaGVycygpO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlV2F0Y2hlcnMoKSB7XG4gICAgICAgICAgICAgICAgb25TZWFyY2hXYXRjaCgpO1xuICAgICAgICAgICAgICAgIC8vIG9uWm9vbVdhdGNoKCk7XG4gICAgICAgICAgICAgICAgb25FeHBhbmRXYXRjaCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBvbkV4cGFuZFdhdGNoKCkge1xuICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0b29sU2V0U2VydmljZS5pc0V4cGFuZEFsbE1vZGUoKVxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChpc0luRXhwYW5kQWxsTW9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNJbkV4cGFuZEFsbE1vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGFuZEFsbEluQ2hhaW4oKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbGxhcHNlQWxsSW5DaGFpbigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gZXhwYW5kQWxsSW5DaGFpbigpIHtcbiAgICAgICAgICAgICAgICBmb3JjZVNjYWxlKDAuNSk7XG4gICAgICAgICAgICAgICAgdG9vbFNldFNlcnZpY2Uuc2V0Wm9vbVNjYWxlKDAuNSk7XG4gICAgICAgICAgICAgICAgY2VudGVyVGhlUm9vdCgpO1xuICAgICAgICAgICAgICAgIC8vIGZvcmNlWm9vbSgpO1xuICAgICAgICAgICAgICAgIGV4cGFuZEFsbCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjb2xsYXBzZUFsbEluQ2hhaW4oKSB7XG4gICAgICAgICAgICAgICAgZm9yY2VTY2FsZSgxKTtcbiAgICAgICAgICAgICAgICB0b29sU2V0U2VydmljZS5zZXRab29tU2NhbGUoMSk7XG4gICAgICAgICAgICAgICAgY2VudGVyVGhlUm9vdCgpO1xuICAgICAgICAgICAgICAgIC8qICAgICAgICAgICAgICAgIGZvcmNlWm9vbSgpOyovXG4gICAgICAgICAgICAgICAgY29sbGFwc2VBbGwoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gb25TZWFyY2hXYXRjaCgpIHtcbiAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJlZVZpZXdTZXJ2aWNlLmdldFNlYXJjaGVkTm9kZSgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9GaXJzdCBmaW5kIGFuZCBoaWdobGlnaHQgdGhlIHBhdGhcbiAgICAgICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodFBhdGgobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzb2x2ZWROb2RlID0gZ2V0VHJlZU5vZGVCeU9iamVjdChub2RlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vVE9ETyByZW1vdmUgbGF0ZXIgY296IGV4cGFuZGluZyBvY2N1cnMgd2hlbiBoaWdobGlnaHRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qICAgICAgICAgICAgICAgICAgICAgICAgZXhwYW5kTm9kZShyZXNvbHZlZE5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZShyZXNvbHZlZE5vZGUpOyovXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNvbHZlZE5vZGUueCwgcmVzb2x2ZWROb2RlLnkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyQWxsQWN0aXZlTm9kZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtlTm9kZUFjdGl2ZShyZXNvbHZlZE5vZGUuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhblRvVGhlTm9kZShyZXNvbHZlZE5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgNTAwKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIG9uWm9vbVdhdGNoKCkge1xuICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0b29sU2V0U2VydmljZS5nZXRab29tU2NhbGUoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoem9vbVNjYWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHpvb21TY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIHZpcy50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbig3NTApXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2FsbCh6b29tT2JqZWN0LnRyYW5zbGF0ZShbMTUwLCAxMDBdKS5zY2FsZSh6b29tU2NhbGUpLnNjYWxlRXh0ZW50KFsxLCA4XSkuZXZlbnQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGZvcmNlWm9vbSgpIHtcbiAgICAgICAgICAgICAgICB2YXIgem9vbVNjYWxlID0gdG9vbFNldFNlcnZpY2UuZ2V0Wm9vbVNjYWxlKCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coem9vbVNjYWxlKTtcbiAgICAgICAgICAgICAgICB2aXMudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbig3NTApXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHpvb21PYmplY3QudHJhbnNsYXRlKFswLCAwXSkuc2NhbGUoem9vbVNjYWxlKS5zY2FsZUV4dGVudChbMC4zLCA4XSkuZXZlbnQpO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGZvcmNlU2NhbGUoc2NhbGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdmlldyA9IHtcbiAgICAgICAgICAgICAgICAgICAgeDogMCxcbiAgICAgICAgICAgICAgICAgICAgeTogMCxcbiAgICAgICAgICAgICAgICAgICAgazogc2NhbGVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGludGVycG9sYXRlWm9vbShbdmlldy54LCB2aWV3LnldLCB2aWV3LmspO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBEZWZpbmUgdGhlIGRyYWcgbGlzdGVuZXJzIGZvciBkcmFnL2Ryb3AgYmVoYXZpb3VyIG9mIG5vZGVzLlxuICAgICAgICAgICAgZHJhZ0xpc3RlbmVyID0gZDMuYmVoYXZpb3IuZHJhZygpXG4gICAgICAgICAgICAgICAgLm9uKFwiZHJhZ3N0YXJ0XCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQgPT0gcm9vdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRyYWdTdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXMgPSB0cmVlLm5vZGVzKGQpO1xuICAgICAgICAgICAgICAgICAgICBkMy5ldmVudC5zb3VyY2VFdmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gaXQncyBpbXBvcnRhbnQgdGhhdCB3ZSBzdXBwcmVzcyB0aGUgbW91c2VvdmVyIGV2ZW50IG9uIHRoZSBub2RlIGJlaW5nIGRyYWdnZWQuIE90aGVyd2lzZSBpdCB3aWxsIGFic29yYiB0aGUgbW91c2VvdmVyIGV2ZW50IGFuZCB0aGUgdW5kZXJseWluZyBub2RlIHdpbGwgbm90IGRldGVjdCBpdCBkMy5zZWxlY3QodGhpcykuYXR0cigncG9pbnRlci1ldmVudHMnLCAnbm9uZScpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLm9uKFwiZHJhZ1wiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkID09IHJvb3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZHJhZ1N0YXJ0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvbU5vZGUgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5pdGlhdGVEcmFnKGQsIGRvbU5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIGdldCBjb29yZHMgb2YgbW91c2VFdmVudCByZWxhdGl2ZSB0byBzdmcgY29udGFpbmVyIHRvIGFsbG93IGZvciBwYW5uaW5nXG4gICAgICAgICAgICAgICAgICAgIHJlbENvb3JkcyA9IGQzLm1vdXNlKCQoJ3N2ZycpLmdldCgwKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZWxDb29yZHNbMF0gPCBwYW5Cb3VuZGFyeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFuVGltZXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFuKHRoaXMsICdsZWZ0Jyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVsQ29vcmRzWzBdID4gKCQoJ3N2ZycpLndpZHRoKCkgLSBwYW5Cb3VuZGFyeSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhblRpbWVyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhbih0aGlzLCAncmlnaHQnKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZWxDb29yZHNbMV0gPCBwYW5Cb3VuZGFyeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFuVGltZXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFuKHRoaXMsICd1cCcpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlbENvb3Jkc1sxXSA+ICgkKCdzdmcnKS5oZWlnaHQoKSAtIHBhbkJvdW5kYXJ5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFuVGltZXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFuKHRoaXMsICdkb3duJyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChwYW5UaW1lcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGQueDAgKz0gZDMuZXZlbnQuZHg7XG4gICAgICAgICAgICAgICAgICAgIGQueTAgKz0gZDMuZXZlbnQuZHk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGUgPSBkMy5zZWxlY3QodGhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgbm9kZS5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgZC54MCArIFwiLFwiICsgZC55MCArIFwiKVwiKTtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlVGVtcENvbm5lY3RvcigpO1xuICAgICAgICAgICAgICAgIH0pLm9uKFwiZHJhZ2VuZFwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkID09IHJvb3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBkb21Ob2RlID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm93IHJlbW92ZSB0aGUgZWxlbWVudCBmcm9tIHRoZSBwYXJlbnQsIGFuZCBpbnNlcnQgaXQgaW50byB0aGUgbmV3IGVsZW1lbnRzIGNoaWxkcmVuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBkcmFnZ2luZ05vZGUucGFyZW50LmNoaWxkcmVuLmluZGV4T2YoZHJhZ2dpbmdOb2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJhZ2dpbmdOb2RlLnBhcmVudC5jaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBzZWxlY3RlZE5vZGUuY2hpbGRyZW4gIT09ICd1bmRlZmluZWQnIHx8IHR5cGVvZiBzZWxlY3RlZE5vZGUuX2NoaWxkcmVuICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygc2VsZWN0ZWROb2RlLmNoaWxkcmVuICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZE5vZGUuY2hpbGRyZW4ucHVzaChkcmFnZ2luZ05vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkTm9kZS5fY2hpbGRyZW4ucHVzaChkcmFnZ2luZ05vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWROb2RlLmNoaWxkcmVuID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWROb2RlLmNoaWxkcmVuLnB1c2goZHJhZ2dpbmdOb2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IHRoZSBub2RlIGJlaW5nIGFkZGVkIHRvIGlzIGV4cGFuZGVkIHNvIHVzZXIgY2FuIHNlZSBhZGRlZCBub2RlIGlzIGNvcnJlY3RseSBtb3ZlZFxuICAgICAgICAgICAgICAgICAgICAgICAgLyogICAgICAgICAgICAgICAgICAgICAgICBleHBhbmQoc2VsZWN0ZWROb2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRUcmVlKCk7Ki9cbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZERyYWcoKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZERyYWcoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZnVuY3Rpb24gaW5pdGlhdGVEcmFnKGQsIGRvbU5vZGUpIHtcbiAgICAgICAgICAgICAgICBkcmFnZ2luZ05vZGUgPSBkO1xuICAgICAgICAgICAgICAgIGQzLnNlbGVjdChkb21Ob2RlKS5zZWxlY3QoJy5naG9zdC1hcmVhJykuYXR0cigncG9pbnRlci1ldmVudHMnLCAnbm9uZScpO1xuICAgICAgICAgICAgICAgIGQzLnNlbGVjdEFsbCgnLmdob3N0LWFyZWEnKS5hdHRyKCdjbGFzcycsICdnaG9zdC1hcmVhIHNob3cnKTtcbiAgICAgICAgICAgICAgICBkMy5zZWxlY3QoZG9tTm9kZSkuYXR0cignY2xhc3MnLCAnbm9kZSBhY3RpdmUtZHJhZycpO1xuICAgICAgICAgICAgICAgIHZpcy5zZWxlY3RBbGwoXCJnLm5vZGVcIikuc29ydChmdW5jdGlvbihhLCBiKSB7IC8vIHNlbGVjdCB0aGUgcGFyZW50IGFuZCBzb3J0IHRoZSBwYXRoJ3NcbiAgICAgICAgICAgICAgICAgICAgaWYgKGEuaWQgIT0gZHJhZ2dpbmdOb2RlLmlkKSByZXR1cm4gMTsgLy8gYSBpcyBub3QgdGhlIGhvdmVyZWQgZWxlbWVudCwgc2VuZCBcImFcIiB0byB0aGUgYmFja1xuICAgICAgICAgICAgICAgICAgICBlbHNlIHJldHVybiAtMTsgLy8gYSBpcyB0aGUgaG92ZXJlZCBlbGVtZW50LCBicmluZyBcImFcIiB0byB0aGUgZnJvbnRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyBpZiBub2RlcyBoYXMgY2hpbGRyZW4sIHJlbW92ZSB0aGUgbGlua3MgYW5kIG5vZGVzXG4gICAgICAgICAgICAgICAgaWYgKG5vZGVzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGxpbmsgcGF0aHNcbiAgICAgICAgICAgICAgICAgICAgbGlua3MgPSB0cmVlLmxpbmtzKG5vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZVBhdGhzID0gdmlzLnNlbGVjdEFsbChcInBhdGgubGlua1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEobGlua3MsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC50YXJnZXQuaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGNoaWxkIG5vZGVzXG4gICAgICAgICAgICAgICAgICAgIG5vZGVzRXhpdCA9IHZpcy5zZWxlY3RBbGwoXCJnLm5vZGVcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRhKG5vZGVzLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5maWx0ZXIoZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmlkID09IGRyYWdnaW5nTm9kZS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBwYXJlbnQgbGlua1xuICAgICAgICAgICAgICAgIHBhcmVudExpbmsgPSB0cmVlLmxpbmtzKHRyZWUubm9kZXMoZHJhZ2dpbmdOb2RlLnBhcmVudCkpO1xuICAgICAgICAgICAgICAgIHZpcy5zZWxlY3RBbGwoJ3BhdGgubGluaycpLmZpbHRlcihmdW5jdGlvbihkLCBpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLnRhcmdldC5pZCA9PSBkcmFnZ2luZ05vZGUuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICBkcmFnU3RhcnRlZCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmdW5jdGlvbiBwYW4oZG9tTm9kZSwgZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNwZWVkID0gcGFuU3BlZWQ7XG4gICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZVg7XG4gICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZVk7XG4gICAgICAgICAgICAgICAgdmFyIHNjYWxlWDtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGVZO1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZTtcbiAgICAgICAgICAgICAgICBpZiAocGFuVGltZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHBhblRpbWVyKTtcbiAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRlQ29vcmRzID0gZDMudHJhbnNmb3JtKHZpcy5hdHRyKFwidHJhbnNmb3JtXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRpcmVjdGlvbiA9PSAnbGVmdCcgfHwgZGlyZWN0aW9uID09ICdyaWdodCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0ZVggPSBkaXJlY3Rpb24gPT0gJ2xlZnQnID8gdHJhbnNsYXRlQ29vcmRzLnRyYW5zbGF0ZVswXSArIHNwZWVkIDogdHJhbnNsYXRlQ29vcmRzLnRyYW5zbGF0ZVswXSAtIHNwZWVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRlWSA9IHRyYW5zbGF0ZUNvb3Jkcy50cmFuc2xhdGVbMV07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09ICd1cCcgfHwgZGlyZWN0aW9uID09ICdkb3duJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRlWCA9IHRyYW5zbGF0ZUNvb3Jkcy50cmFuc2xhdGVbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGVZID0gZGlyZWN0aW9uID09ICd1cCcgPyB0cmFuc2xhdGVDb29yZHMudHJhbnNsYXRlWzFdICsgc3BlZWQgOiB0cmFuc2xhdGVDb29yZHMudHJhbnNsYXRlWzFdIC0gc3BlZWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2NhbGVYID0gdHJhbnNsYXRlQ29vcmRzLnNjYWxlWzBdO1xuICAgICAgICAgICAgICAgICAgICBzY2FsZVkgPSB0cmFuc2xhdGVDb29yZHMuc2NhbGVbMV07XG4gICAgICAgICAgICAgICAgICAgIHNjYWxlID0gdG9vbFNldFNlcnZpY2UuZ2V0Wm9vbVNjYWxlKCk7XG4gICAgICAgICAgICAgICAgICAgIHZpcy50cmFuc2l0aW9uKCkuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIHRyYW5zbGF0ZVggKyBcIixcIiArIHRyYW5zbGF0ZVkgKyBcIilzY2FsZShcIiArIHNjYWxlICsgXCIpXCIpO1xuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QoZG9tTm9kZSkuc2VsZWN0KCdnLm5vZGUnKS5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgdHJhbnNsYXRlWCArIFwiLFwiICsgdHJhbnNsYXRlWSArIFwiKVwiKTtcbiAgICAgICAgICAgICAgICAgICAgem9vbS5zY2FsZShzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgIHpvb20udHJhbnNsYXRlKFt0cmFuc2xhdGVYLCB0cmFuc2xhdGVZXSk7XG4gICAgICAgICAgICAgICAgICAgIHBhblRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhbihkb21Ob2RlLCBzcGVlZCwgZGlyZWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgNTApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEZ1bmN0aW9uIHRvIHVwZGF0ZSB0aGUgdGVtcG9yYXJ5IGNvbm5lY3RvciBpbmRpY2F0aW5nIGRyYWdnaW5nIGFmZmlsaWF0aW9uXG4gICAgICAgICAgICB2YXIgdXBkYXRlVGVtcENvbm5lY3RvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gW107XG4gICAgICAgICAgICAgICAgaWYgKGRyYWdnaW5nTm9kZSAhPT0gbnVsbCAmJiBzZWxlY3RlZE5vZGUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaGF2ZSB0byBmbGlwIHRoZSBzb3VyY2UgY29vcmRpbmF0ZXMgc2luY2Ugd2UgZGlkIHRoaXMgZm9yIHRoZSBleGlzdGluZyBjb25uZWN0b3JzIG9uIHRoZSBvcmlnaW5hbCB0cmVlXG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBbe1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeDogc2VsZWN0ZWROb2RlLngwICsobm9kZUJvdW5kYXJpZXMud2lkdGgvMiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeTogc2VsZWN0ZWROb2RlLnkwK25vZGVCb3VuZGFyaWVzLmhlaWdodCsxMFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHg6IGRyYWdnaW5nTm9kZS54MCsobm9kZUJvdW5kYXJpZXMud2lkdGgvMiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeTogZHJhZ2dpbmdOb2RlLnkwXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgbGluayA9IHZpcy5zZWxlY3RBbGwoXCIudGVtcC1saW5rXCIpLmRhdGEoZGF0YSk7XG4gICAgICAgICAgICAgICAgbGluay5lbnRlcigpLmFwcGVuZChcInBhdGhcIilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcInRlbXAtbGlua1wiKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcImRcIiwgZDMuc3ZnLmRpYWdvbmFsKCkpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdwb2ludGVyLWV2ZW50cycsICdub25lJyk7XG4gICAgICAgICAgICAgICAgbGluay5hdHRyKFwiZFwiLCBkMy5zdmcuZGlhZ29uYWwoKSk7XG4gICAgICAgICAgICAgICAgbGluay5leGl0KCkucmVtb3ZlKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgb3ZlckluR2hvc3RBcmVhID0gZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIHNlbGVjdGVkTm9kZSA9IGQ7XG4gICAgICAgICAgICAgICAgdXBkYXRlVGVtcENvbm5lY3RvcigpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIG91dE9mR2hvc3RBcmVhID0gZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIHNlbGVjdGVkTm9kZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgdXBkYXRlVGVtcENvbm5lY3RvcigpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gZW5kRHJhZygpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RlZE5vZGUgPSBudWxsO1xuICAgICAgICAgICAgICAgIGQzLnNlbGVjdEFsbCgnLmdob3N0LWFyZWEnKS5hdHRyKCdjbGFzcycsICdnaG9zdC1hcmVhJyk7XG4gICAgICAgICAgICAgICAgZDMuc2VsZWN0KGRvbU5vZGUpLmF0dHIoJ2NsYXNzJywgJ25vZGUnKTtcbiAgICAgICAgICAgICAgICAvLyBub3cgcmVzdG9yZSB0aGUgbW91c2VvdmVyIGV2ZW50IG9yIHdlIHdvbid0IGJlIGFibGUgdG8gZHJhZyBhIDJuZCB0aW1lXG4gICAgICAgICAgICAgICAgZDMuc2VsZWN0KGRvbU5vZGUpLnNlbGVjdCgnLmdob3N0LWFyZWEnKS5hdHRyKCdwb2ludGVyLWV2ZW50cycsICcnKTtcbiAgICAgICAgICAgICAgICB1cGRhdGVUZW1wQ29ubmVjdG9yKCk7XG4gICAgICAgICAgICAgICAgaWYgKGRyYWdnaW5nTm9kZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGUocm9vdCk7XG4gICAgICAgICAgICAgICAgICAgIHBhblRvVGhlTm9kZShkcmFnZ2luZ05vZGUpO1xuICAgICAgICAgICAgICAgICAgICBkcmFnZ2luZ05vZGUgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgb25Jbml0KCk7XG5cbiAgICAgICAgICAgIHZhciB2aXMgPSB3cmFwcGVyRWxlbWVudC5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgICAgICAgICAuYXR0cihcImxheW91dFwiLCBcInJvd1wiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwibGF5b3V0LWFsaWduXCIsIFwic3BhY2UtYXJvdW5kIGNlbnRlclwiKVxuICAgICAgICAgICAgICAgIC5jYWxsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gJGNvbXBpbGUodGhpc1swXSkoc2NvcGUpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmFwcGVuZChcImRpdlwiKS5hdHRyKFwiZmxleFwiLCBcIlwiKS5jYWxsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gJGNvbXBpbGUodGhpc1swXSkoc2NvcGUpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmFwcGVuZChcInN2ZzpzdmdcIilcbiAgICAgICAgICAgICAgICAuYXR0cihcInZpZXdCb3hcIiwgdmlld0JveEJvdW5kYXJ5KVxuICAgICAgICAgICAgICAgIC5hdHRyKFwic3R5bGVcIixcImN1cnNvcjptb3ZlO1wiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgXCIxMDAlXCIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgaUhlaWdodClcbiAgICAgICAgICAgICAgICAvKiAgICAgICAgICAgICAgICAuY2FsbChkMy5iZWhhdmlvci56b29tKCkub24oXCJ6b29tXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xTZXRTZXJ2aWNlLnNldFpvb21TY2FsZShkMy5ldmVudC5zY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGQzLmV2ZW50LnNjYWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGQzLmV2ZW50LnNjYWxlPjAuNSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdmlzLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyBkMy5ldmVudC50cmFuc2xhdGUgKyBcIilcIiArIFwiIHNjYWxlKFwiICsgZDMuZXZlbnQuc2NhbGUgKyBcIilcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdmlzLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyBkMy5ldmVudC50cmFuc2xhdGUgKyBcIilcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKSovXG4gICAgICAgICAgICAgICAgLmNhbGwoem9vbSlcbiAgICAgICAgICAgICAgICAvLyAuY2FsbCh6b29tT2JqZWN0KVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJzdmc6Z1wiKVxuICAgICAgICAgICAgICAgIC8vLmF0dHIoXCJwb2ludGVyLWV2ZW50c1wiLCBcImFsbFwiKVxuICAgICAgICAgICAgICAgIC8vY2VudGVyaW5nIHRoZSByb290IG5vZGVcbiAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArICgoJHdpbmRvdy5pbm5lcldpZHRoIC8gMikgLSAxMjApICsgXCIsXCIgKyAoaCAvIDQpICsgXCIpXCIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJzdHlsZVwiLCBcImN1cnNvcjpwb2ludGVyO1wiKVxuICAgICAgICAgICAgICAgIC8vLmNhbGwoZDMuYmVoYXZpb3Iuem9vbSgpLnNjYWxlRXh0ZW50KFsxLDhdKS5vbihcInpvb21cIix6b29tKSk7XG4gICAgICAgICAgICAgICAgLy8uY2FsbChkMy5iZWhhdmlvci56b29tKCkueCh4KS55KHkpLnNjYWxlRXh0ZW50KFsxLCA4XSkub25cbiAgICAgICAgICAgICAgICAub24oXCJjbGlja1wiLCBzdG9wUHJvcG9nYXRpb24sIGZhbHNlKVxuICAgICAgICAgICAgICAgIC5jYWxsKGQzLmJlaGF2aW9yLmRyYWcoKS5vbihcImRyYWdzdGFydFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGQzLmV2ZW50LnNvdXJjZUV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAvKiAgICAgICAgIHZpcy50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9kdXJhdGlvbiBvZiB0aGUgYW5pbWF0aW9uIG9mIHRyYW5zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbigwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZGVsYXkgdGltZSBpbiBtc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRlbGF5KDApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcInNjYWxlKFwiICsgdG9vbFNldFNlcnZpY2UuZ2V0Wm9vbVNjYWxlKCkgKyBcIilcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICB9KS5vbihcImRyYWdcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRyYWdnZWRcIik7XG4gICAgICAgICAgICAgICAgICAgIC8vIGQzLmV2ZW50LnNvdXJjZUV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJnXCIpLmF0dHIoXCJ3aWR0aFwiLCAxNjApLmF0dHIoXCJoZWlnaHRcIiwgMTIwKS5hdHRyKFwiY2xhc3NcIiwgXCJ0cmVlLWhvbGRlclwiKS8qLmNhbGwoZDMuYmVoYXZpb3IuZHJhZygpLm9uKFwiZHJhZ3N0YXJ0XCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICBkMy5ldmVudC5zb3VyY2VFdmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICB9KS5vbihcImRyYWdcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZHJhZ2dlZFwiKTtcbiAgICAgICAgICAgICB9KSkqLztcblxuXG4gICAgICAgICAgICB2YXIgdHJlZSA9IGQzLmxheW91dC50cmVlKClcbiAgICAgICAgICAgIC8vIC5zaXplKFtoLCB3XSlcbiAgICAgICAgICAgICAgICAubm9kZVNpemUoW25vZGVCb3VuZGFyaWVzLndpZHRoICsgbm9kZUJvdW5kYXJpZXMuaG9yaXpvbnRhbFNlcGVyYXRpb24sIG5vZGVCb3VuZGFyaWVzLmhlaWdodCArIG5vZGVCb3VuZGFyaWVzLnZlcnRpY2FsU2VwZXJhdGlvbl0pXG4gICAgICAgICAgICAgICAgLnNlcGFyYXRpb24oZnVuY3Rpb24gc2VwYXJhdGlvbihhLCBiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhLnBhcmVudCA9PSBiLnBhcmVudCA/IDEuMjUgOiAxLjU7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHZhciBsaW5lID0gZDMuc3ZnLmxpbmUoKVxuXG4gICAgICAgICAgICAgICAgLngoZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHhTY2FsZShkLngpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnkoZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHlTY2FsZShkLnkpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBmZXRjaExpbmVEYXRhKCkge1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2UgPSB7XG4gICAgICAgICAgICAgICAgICAgIFwieFwiOiBkLnNvdXJjZS54ICsgKG5vZGVCb3VuZGFyaWVzLndpZHRoKSAvIDIsXG4gICAgICAgICAgICAgICAgICAgIFwieVwiOiBkLnNvdXJjZS55ICsgKG5vZGVCb3VuZGFyaWVzLmhlaWdodCArIDEwKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJ4XCI6IGQudGFyZ2V0LnggKyAobm9kZUJvdW5kYXJpZXMud2lkdGgpIC8gMixcbiAgICAgICAgICAgICAgICAgICAgXCJ5XCI6IGQudGFyZ2V0LnkgLSAoYXR0cnMuaW1hZ2VwcmVzZW50ID09ICd0cnVlJyA/IDQ1IDogMClcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIGxpbmVEYXRhQXJyYXkgPSBbXTtcbiAgICAgICAgICAgICAgICBsaW5lRGF0YUFycmF5LnB1c2goc291cmNlKTtcbiAgICAgICAgICAgICAgICBsaW5lRGF0YUFycmF5LnB1c2godGFyZ2V0KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBsaW5lRGF0YUFycmF5O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZGlhZ29uYWwgPSBkMy5zdmcuZGlhZ29uYWwoKVxuICAgICAgICAgICAgLyogICAgICAgICAgICAgICAgLnByb2plY3Rpb24oZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtkLnggKyAxMjAsIGQueSArIDExMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7Ki9cbiAgICAgICAgICAgICAgICAuc291cmNlKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInhcIjogZC5zb3VyY2UueCArIChub2RlQm91bmRhcmllcy53aWR0aCkgLyAyLFxuICAgICAgICAgICAgICAgICAgICAgICAgLypcInlcIjogZC5zb3VyY2UueSArIDE1MCovXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBcInhcIjogZC5zb3VyY2UueCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwieVwiOiBkLnNvdXJjZS55ICsgKG5vZGVCb3VuZGFyaWVzLmhlaWdodCArIDEwKVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnRhcmdldChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJ4XCI6IGQudGFyZ2V0LnggKyAobm9kZUJvdW5kYXJpZXMud2lkdGgpIC8gMixcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qXCJ5XCI6IGQudGFyZ2V0LnkqL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gXCJ4XCI6IGQudGFyZ2V0LngsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInlcIjogZC50YXJnZXQueSAtIChhdHRycy5pbWFnZXByZXNlbnQgPT0gJ3RydWUnID8gNDUgOiAwKVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnByb2plY3Rpb24oZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtkLnggKyAwLCBkLnkgKyAwXTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJvb3QgPSB2bS50cmVlZGF0YTtcbiAgICAgICAgICAgIHJvb3QueDAgPSBoIC8gMjtcbiAgICAgICAgICAgIHJvb3QueTAgPSAwO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiB0b2dnbGVBbGwoZCkge1xuICAgICAgICAgICAgICAgIGlmIChkLmNoaWxkcmVuKSB7XG4gICAgICAgICAgICAgICAgICAgIGQuY2hpbGRyZW4uZm9yRWFjaCh0b2dnbGVBbGwpO1xuICAgICAgICAgICAgICAgICAgICB0b2dnbGUoZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gZXhwYW5kQWxsQWZ0ZXIoZCkge1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbiA9IChkLmNoaWxkcmVuKSA/IGQuY2hpbGRyZW4gOiBkLl9jaGlsZHJlbjtcbiAgICAgICAgICAgICAgICBpZiAoZC5fY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgZC5jaGlsZHJlbiA9IGQuX2NoaWxkcmVuO1xuICAgICAgICAgICAgICAgICAgICBkLl9jaGlsZHJlbiA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbilcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW4uZm9yRWFjaChleHBhbmRBbGxBZnRlcik7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBjb2xsYXBzZUFsbEFmdGVyKGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW4gPSAoZC5jaGlsZHJlbikgPyBkLmNoaWxkcmVuIDogZC5fY2hpbGRyZW47XG4gICAgICAgICAgICAgICAgaWYgKGQuY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgZC5fY2hpbGRyZW4gPSBkLmNoaWxkcmVuO1xuICAgICAgICAgICAgICAgICAgICBkLmNoaWxkcmVuID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuKVxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbi5mb3JFYWNoKGNvbGxhcHNlQWxsQWZ0ZXIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBleHBhbmRBbGwoKSB7XG4gICAgICAgICAgICAgICAgZXhwYW5kQWxsQWZ0ZXIocm9vdCk7XG4gICAgICAgICAgICAgICAgdXBkYXRlKHJvb3QpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjb2xsYXBzZUFsbCgpIHtcbiAgICAgICAgICAgICAgICBjb2xsYXBzZUFsbEFmdGVyKHJvb3QpO1xuICAgICAgICAgICAgICAgIHVwZGF0ZShyb290KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc29sZS5sb2cocm9vdCk7XG5cbiAgICAgICAgICAgIC8vIGluaXRpYWxpemUgdGhlIGRpc3BsYXkgdG8gc2hvdyBhIGZldyBub2Rlcy5cbiAgICAgICAgICAgIHJvb3QuY2hpbGRyZW4uZm9yRWFjaCh0b2dnbGVBbGwpO1xuXG5cbiAgICAgICAgICAgIHVwZGF0ZShyb290KTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRlKHNvdXJjZSkge1xuICAgICAgICAgICAgICAgIHZhciBkdXJhdGlvbiA9IGQzLmV2ZW50ICYmIGQzLmV2ZW50LmFsdEtleSA/IDUwMDAgOiA1MDA7XG5cbiAgICAgICAgICAgICAgICAvLyBDb21wdXRlIHRoZSBuZXcgdHJlZSBsYXlvdXQuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdHJlZS5ub2Rlcyhyb290KS5yZXZlcnNlKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBOb3JtYWxpemUgZm9yIGZpeGVkLWRlcHRoLlxuICAgICAgICAgICAgICAgIG5vZGVzLmZvckVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC55ID0gZC5kZXB0aCAqIDMwMDtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgbm9kZXMuLi5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IHZpcy5zZWxlY3RBbGwoXCJnLm5vZGVcIilcbiAgICAgICAgICAgICAgICAgICAgLmRhdGEobm9kZXMsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5pZCB8fCAoZC5pZCA9ICsraSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gRW50ZXIgYW55IG5ldyBub2RlcyBhdCB0aGUgcGFyZW50J3MgcHJldmlvdXMgcG9zaXRpb24uXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVFbnRlciA9IG5vZGUuZW50ZXIoKS5hcHBlbmQoXCJzdmc6Z1wiKVxuICAgICAgICAgICAgICAgICAgICAuY2FsbChkcmFnTGlzdGVuZXIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJub2RlXCIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiaWRcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcIm5vZGUtXCIgKyBkLmlkO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgc291cmNlLngwICsgXCIsXCIgKyBzb3VyY2UueTAgKyBcIilcIjtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkMy5ldmVudC5kZWZhdWx0UHJldmVudGVkKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRvZ2dsZShkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZShkKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBub2RlRW50ZXIuYXBwZW5kKFwicmVjdFwiKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnZ2hvc3QtYXJlYScpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgbm9kZUJvdW5kYXJpZXMud2lkdGgpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIG5vZGVCb3VuZGFyaWVzLmhlaWdodCsxNTApXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwib3BhY2l0eVwiLCAwLjIpIC8vIGNoYW5nZSB0aGlzIHRvIHplcm8gdG8gaGlkZSB0aGUgdGFyZ2V0IGFyZWFcbiAgICAgICAgICAgICAgICAgICAgLnN0eWxlKFwiZmlsbFwiLCBcInRyYW5zcGFyZW50XCIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdwb2ludGVyLWV2ZW50cycsICdtb3VzZW92ZXInKVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3ZlckluR2hvc3RBcmVhKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRPZkdob3N0QXJlYShub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZVRleHQgPSBub2RlRW50ZXJcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcInN2Zzpmb3JlaWduT2JqZWN0XCIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLmNoaWxkcmVuIHx8IGQuX2NoaWxkcmVuID8gXCJlbmRcIiA6IFwic3RhcnRcIjtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLnN0eWxlKFwiZmlsbC1vcGFjaXR5XCIsIDFlLTYpXG4gICAgICAgICAgICAgICAgICAgIC8vIC5zdHlsZShcIm92ZXJmbG93XCIsIFwidmlzaWJsZVwiKVxuICAgICAgICAgICAgICAgICAgICAvLyAuY2xhc3NlZChcIm9mXCIsZnVuY3Rpb24oKXtyZXR1cm4gdHJ1ZTt9KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignd2lkdGgnLCBub2RlQm91bmRhcmllcy53aWR0aClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIG5vZGVCb3VuZGFyaWVzLmhlaWdodClcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgneGh0bWw6ZGl2JylcbiAgICAgICAgICAgICAgICAgICAgLmNsYXNzZWQoXCJkaXNhYmxlZFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuZW5hYmxlICE9PSB1bmRlZmluZWQgJiYgIWQuZW5hYmxlO1xuICAgICAgICAgICAgICAgICAgICB9KS5vbihcImNsaWNrXCIsIG9uQ2xpY2tlZE5vZGUpLyouY2FsbChkMy5iZWhhdmlvci5kcmFnKCkub24oXCJkcmFnc3RhcnRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICBkMy5ldmVudC5zb3VyY2VFdmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgfSkub24oXCJkcmFnXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJkcmFnZ2VkXCIpO1xuICAgICAgICAgICAgICAgICB9KSkqLztcblxuICAgICAgICAgICAgICAgIG5vZGVUZXh0LmFwcGVuZChcInRyZWUtbm9kZVwiKS5hdHRyKFwibm9kZVwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICB0cmVlVmlld1NlcnZpY2UucHVzaE5vZGUoZCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoXCJub2RlSWRcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuaWQ7XG4gICAgICAgICAgICAgICAgfSkuYXR0cihcImltYWdlUHJlc2VudFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdm0uaW1hZ2VwcmVzZW50O1xuICAgICAgICAgICAgICAgIH0pLmF0dHIoXCJpc1Bpbm5lZE5vZGVcIiwgXCJmYWxzZVwiKS5hdHRyKFwibm9kZUFjdGlvbnNcIiwgYXR0cnMubm9kZWFjdGlvbnMpXG4gICAgICAgICAgICAgICAgICAgIC5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRjb21waWxlKHRoaXMpKHNjb3BlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBUcmFuc2l0aW9uIG5vZGVzIHRvIHRoZWlyIG5ldyBwb3NpdGlvbi5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZVVwZGF0ZSA9IG5vZGUudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbihkdXJhdGlvbilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCI7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVVcGRhdGUuc2VsZWN0KFwiY2lyY2xlXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInJcIiwgNC41KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN0eWxlKFwiZmlsbFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmNsYXNzID09PSAnaGlnaGxpZ2h0LWxpbmsnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnI2ZmNDEzNic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkLl9jaGlsZHJlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ2xpZ2h0c3RlZWxibHVlJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyNmZmYnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVVcGRhdGUuc2VsZWN0KFwidGV4dFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN0eWxlKFwiZmlsbC1vcGFjaXR5XCIsIDEpOyovXG5cbiAgICAgICAgICAgICAgICAvLyBUcmFuc2l0aW9uIGV4aXRpbmcgbmRvZXMgdG8gdGhlIHBhcmVudCdzIG5ldyBwb3NpdGlvbi5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZUV4aXQgPSBub2RlLmV4aXQoKS50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgLmR1cmF0aW9uKGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgc291cmNlLnggKyBcIixcIiArIHNvdXJjZS55ICsgXCIpXCI7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5yZW1vdmUoKTtcblxuICAgICAgICAgICAgICAgIG5vZGVFeGl0LnNlbGVjdChcImNpcmNsZVwiKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInJcIiwgMWUtNik7XG4gICAgICAgICAgICAgICAgbm9kZUV4aXQuc2VsZWN0KFwidGV4dFwiKVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoXCJmaWxsLW9wYWNpdHlcIiwgMWUtNik7XG5cbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIGxpbmtzLi4uXG4gICAgICAgICAgICAgICAgdmFyIGxpbmsgPSB2aXMuc2VsZWN0QWxsKFwicGF0aC5saW5rXCIpXG4gICAgICAgICAgICAgICAgICAgIC5kYXRhKHRyZWUubGlua3Mobm9kZXMpLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQudGFyZ2V0LmlkO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vIEVudGVyIGFueSBuZXcgbGlua3MgYXQgaHRlIHBhcmVudCdzIHByZXZpb3VzIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgbGluay5lbnRlcigpLmluc2VydChcInN2ZzpwYXRoXCIsIFwiZ1wiKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwibGlua1wiKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcImRcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHg6IHNvdXJjZS54MCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5OiBzb3VyY2UueTBcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGlhZ29uYWwoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IG9cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbihkdXJhdGlvbilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkXCIsIGRpYWdvbmFsKTtcbiAgICAgICAgICAgICAgICAvKiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiTVwiICsgZC5zb3VyY2UueSArIFwiLFwiICsgZC5zb3VyY2UueFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIFwiQ1wiICsgKGQudGFyZ2V0LnkgKyAxMDApICsgXCIsXCIgKyBkLnNvdXJjZS54XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgXCIgXCIgKyAoZC50YXJnZXQueSArIDEwMCkgKyBcIixcIiArIGQudGFyZ2V0LnhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBcIiBcIiArIGQudGFyZ2V0LnkgKyBcIixcIiArIGQudGFyZ2V0Lng7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsqL1xuXG4gICAgICAgICAgICAgICAgLy8gVHJhbnNpdGlvbiBsaW5rcyB0byB0aGVpciBuZXcgcG9zaXRpb24uXG4gICAgICAgICAgICAgICAgbGluay50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgLmR1cmF0aW9uKGR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcImRcIiwgZGlhZ29uYWwpXG4gICAgICAgICAgICAgICAgICAgIC8qICAgICAgICAgICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoZC50YXJnZXQuY2xhc3MgPT09IFwiaGlnaGxpZ2h0LWxpbmtcIik/XCJoaWdobGlnaHQtbGluay1zdHJva2UtYWN0aXZlXCI6XCJoaWdobGlnaHQtbGluay1zdHJva2UtaW5hY3RpdmVcIjtcbiAgICAgICAgICAgICAgICAgICAgIH0pOyovXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZShcInN0cm9rZVwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQudGFyZ2V0LmNsYXNzID09PSBcImhpZ2hsaWdodC1saW5rXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCIjZmY0MTM2XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gVHJhbnNpdGlvbiBleGl0aW5nIG5vZGVzIHRvIHRoZSBwYXJlbnQncyBuZXcgcG9zaXRpb24uXG4gICAgICAgICAgICAgICAgbGluay5leGl0KCkudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbihkdXJhdGlvbilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4OiBzb3VyY2UueCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5OiBzb3VyY2UueVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkaWFnb25hbCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBvLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogb1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5yZW1vdmUoKTtcblxuICAgICAgICAgICAgICAgIC8vIFN0YXNoIHRoZSBvbGQgcG9zaXRpb25zIGZvciB0cmFuc2l0aW9uLlxuICAgICAgICAgICAgICAgIG5vZGVzLmZvckVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC54MCA9IGQueDtcbiAgICAgICAgICAgICAgICAgICAgZC55MCA9IGQueTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmNvcHkobm9kZXMsIG5vZGVMaXN0KTtcblxuICAgICAgICAgICAgICAgIHRyZWVWaWV3U2VydmljZS5zZXROb2Rlcyhub2RlTGlzdCk7XG4gICAgICAgICAgICB9XG5cbi8vIFRvZ2dsZSBjaGlsZHJlblxuICAgICAgICAgICAgZnVuY3Rpb24gdG9nZ2xlKGQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZC5jaGlsZHJlbikge1xuICAgICAgICAgICAgICAgICAgICBkLl9jaGlsZHJlbiA9IGQuY2hpbGRyZW47XG4gICAgICAgICAgICAgICAgICAgIGQuY2hpbGRyZW4gPSBudWxsO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGQuY2hpbGRyZW4gPSBkLl9jaGlsZHJlbjtcbiAgICAgICAgICAgICAgICAgICAgZC5fY2hpbGRyZW4gPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gZXhwYW5kTm9kZShub2RlKSB7XG4gICAgICAgICAgICAgICAgbm9kZS5jaGlsZHJlbiA9IG5vZGUuX2NoaWxkcmVuO1xuICAgICAgICAgICAgICAgIG5vZGUuX2NoaWxkcmVuID0gbnVsbDtcbiAgICAgICAgICAgIH1cblxuLy8gem9vbSBpbiAvIG91dFxuLy8gICAgICAgICAgICAgZnVuY3Rpb24gem9vbShkKSB7XG4vLyAgICAgICAgICAgICAgICAgLy92aXMuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbDNhdGUoXCIgKyBkMy5ldmVudC50cmFuc2xhdGUgKyBcIilzY2FsZShcIiArIGQzLmV2ZW50LnNjYWxlICsgXCIpXCIpO1xuLy8gICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHZpcy5zZWxlY3RBbGwoXCJnLm5vZGVcIik7XG4vLyAgICAgICAgICAgICAgICAgbm9kZXMuYXR0cihcInRyYW5zZm9ybVwiLCB0cmFuc2Zvcm0pO1xuLy9cbi8vICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIGxpbmtzLi4uXG4vLyAgICAgICAgICAgICAgICAgdmFyIGxpbmsgPSB2aXMuc2VsZWN0QWxsKFwicGF0aC5saW5rXCIpO1xuLy8gICAgICAgICAgICAgICAgIGxpbmsuYXR0cihcImRcIiwgdHJhbnNsYXRlKTtcbi8vXG4vLyAgICAgICAgICAgICAgICAgLy8gRW50ZXIgYW55IG5ldyBsaW5rcyBhdCBodGUgcGFyZW50J3MgcHJldmlvdXMgcG9zaXRpb25cbi8vICAgICAgICAgICAgICAgICAvL2xpbmsuYXR0cihcImRcIiwgZnVuY3Rpb24oZCkge1xuLy8gICAgICAgICAgICAgICAgIC8vICAgICAgdmFyIG8gPSB7eDogZC54MCwgeTogZC55MH07XG4vLyAgICAgICAgICAgICAgICAgLy8gICAgICByZXR1cm4gZGlhZ29uYWwoe3NvdXJjZTogbywgdGFyZ2V0OiBvfSk7XG4vLyAgICAgICAgICAgICAgICAgLy8gICAgfSk7XG4vLyAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGRldGVybWluZU5vZGVSZWxhdGl2ZUxvY2F0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZC5zb3VyY2UueCA9PSBkLnRhcmdldC54KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnc3RyYWlnaHQnO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZC5zb3VyY2UueCA+IGQudGFyZ2V0LngpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdvbmxlZnQnO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnb25yaWdodCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZW5lcmF0ZVBhdGgoZCkge1xuICAgICAgICAgICAgICAgIHZhciByZWxhdGl2ZUxvY2F0aW9uID0gZGV0ZXJtaW5lTm9kZVJlbGF0aXZlTG9jYXRpb24oZCk7XG4gICAgICAgICAgICAgICAgdmFyIHBhdGhTdHJpbmcgPSAnJztcblxuICAgICAgICAgICAgICAgIHN3aXRjaCAocmVsYXRpdmVMb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdzdHJhaWdodCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRoU3RyaW5nICs9IFwiTSBcIiArIGQuc291cmNlLnggKyBcIixcIiArIGQuc291cmNlLnlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIEwgXCIgKyBkLnNvdXJjZS54ICsgXCIsXCIgKyAoZC50YXJnZXQueSAtIGQuc291cmNlLnkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBcIiBNIFwiICsgZC5zb3VyY2UueCArIFwiLFwiICsgKGQudGFyZ2V0LnkgLSBkLnNvdXJjZS55KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdvbmxlZnQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aFN0cmluZyArPSBcIk0gXCIgKyBkLnNvdXJjZS54ICsgXCIsXCIgKyBkLnNvdXJjZS55XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBcIiBMIFwiICsgZC5zb3VyY2UueCArIFwiLFwiICsgKGQuc291cmNlLnkgKyAxMClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIFEgXCIgKyBkLnNvdXJjZS54ICsgXCIsXCIgKyAoKGQuc291cmNlLnkgKyAxMCkgKyA4KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgXCIgXCIgKyAoZC5zb3VyY2UueCAtIDgpICsgXCIsXCIgKyAoKGQuc291cmNlLnkgKyAxMCkgKyA4KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgXCIgTCBcIiArICgoZC5zb3VyY2UueCAtIDgpIC0gKChkLnRhcmdldC54IC0gZC5zb3VyY2UueCkgLSAxMjApKSArIFwiLFwiICsgKChkLnNvdXJjZS55ICsgMTApICsgOClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIFEgXCIgKyAoKChkLnNvdXJjZS54IC0gOCkgLSAoKGQudGFyZ2V0LnggLSBkLnNvdXJjZS54KSAtIDEyMCkpIC0gOCkgKyBcIixcIiArICgoZC5zb3VyY2UueSArIDEwKSArIDgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBcIiBcIiArICgoKGQuc291cmNlLnggLSA4KSAtICgoZC50YXJnZXQueCAtIGQuc291cmNlLngpIC0gMTIwKSkgLSA4KSArIFwiLFwiICsgKCgoZC5zb3VyY2UueSArIDEwKSArIDgpICsgOClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIEwgXCIgKyAoKChkLnNvdXJjZS54IC0gOCkgLSAoKGQudGFyZ2V0LnggLSBkLnNvdXJjZS54KSAtIDEyMCkpIC0gOCkgKyBcIixcIiArICgoZC50YXJnZXQueSAtIGQuc291cmNlLnkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qKyBcIkNcIiArIChkLnNvdXJjZS54ICsgZC50YXJnZXQueCkgLyAyICsgXCIsXCIgKyBkLnNvdXJjZS55XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBcIiBcIiArIChkLnNvdXJjZS54ICsgZC50YXJnZXQueCkgLyAyICsgXCIsXCIgKyBkLnRhcmdldC55Ki9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyArIFwiIE0gXCIgKyAoKChkLnNvdXJjZS54IC0gOCkgLSAoKGQudGFyZ2V0LngtZC5zb3VyY2UueCktMTIwKSkgLSA4KSArIFwiLFwiICsgKChkLnRhcmdldC55LWQuc291cmNlLnkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIE0gXCIgKyBkLnRhcmdldC54ICsgXCIsXCIgKyBkLnRhcmdldC55O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ29ucmlnaHQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aFN0cmluZyArPSBcIk0gXCIgKyBkLnNvdXJjZS54ICsgXCIsXCIgKyBkLnNvdXJjZS55XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBcIiBMIFwiICsgZC5zb3VyY2UueCArIFwiLFwiICsgKGQuc291cmNlLnkgKyAxMClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIFEgXCIgKyBkLnNvdXJjZS54ICsgXCIsXCIgKyAoKGQuc291cmNlLnkgKyAxMCkgKyA4KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgXCIgXCIgKyAoZC5zb3VyY2UueCArIDgpICsgXCIsXCIgKyAoKGQuc291cmNlLnkgKyAxMCkgKyA4KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgXCIgTCBcIiArICgoZC5zb3VyY2UueCArIDgpIC0gKChkLnRhcmdldC54IC0gZC5zb3VyY2UueCkgLSAxMjApKSArIFwiLFwiICsgKChkLnNvdXJjZS55ICsgMTApICsgOClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIFEgXCIgKyAoKChkLnNvdXJjZS54ICsgOCkgLSAoKGQudGFyZ2V0LnggLSBkLnNvdXJjZS54KSAtIDEyMCkpICsgOCkgKyBcIixcIiArICgoZC5zb3VyY2UueSArIDEwKSArIDgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBcIiBcIiArICgoKGQuc291cmNlLnggKyA4KSAtICgoZC50YXJnZXQueCAtIGQuc291cmNlLngpIC0gMTIwKSkgKyA4KSArIFwiLFwiICsgKCgoZC5zb3VyY2UueSArIDEwKSArIDgpICsgOClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIEwgXCIgKyAoKChkLnNvdXJjZS54ICsgOCkgLSAoKGQudGFyZ2V0LnggLSBkLnNvdXJjZS54KSAtIDEyMCkpICsgOCkgKyBcIixcIiArICgoZC50YXJnZXQueSAtIGQuc291cmNlLnkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qKyBcIkNcIiArIChkLnNvdXJjZS54ICsgZC50YXJnZXQueCkgLyAyICsgXCIsXCIgKyBkLnNvdXJjZS55XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBcIiBcIiArIChkLnNvdXJjZS54ICsgZC50YXJnZXQueCkgLyAyICsgXCIsXCIgKyBkLnRhcmdldC55Ki9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICArIFwiIE0gXCIgKyAoKChkLnNvdXJjZS54ICsgOCkgLSAoKGQudGFyZ2V0LnggLSBkLnNvdXJjZS54KSAtIDEyMCkpICsgOCkgKyBcIixcIiArICgoZC50YXJnZXQueSAtIGQuc291cmNlLnkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBwYXRoU3RyaW5nO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiB0cmFuc2Zvcm0oZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBcInRyYW5zbGF0ZShcIiArIHgoZC55KSArIFwiLFwiICsgeShkLngpICsgXCIpXCI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHRyYW5zbGF0ZShkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNvdXJjZVggPSB4KGQudGFyZ2V0LnBhcmVudC55KTtcbiAgICAgICAgICAgICAgICB2YXIgc291cmNlWSA9IHkoZC50YXJnZXQucGFyZW50LngpO1xuICAgICAgICAgICAgICAgIHZhciB0YXJnZXRYID0geChkLnRhcmdldC55KTtcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0WSA9IChzb3VyY2VYICsgdGFyZ2V0WCkgLyAyO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rVGFyZ2V0WSA9IHkoZC50YXJnZXQueDApO1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBcIk1cIiArIHNvdXJjZVggKyBcIixcIiArIHNvdXJjZVkgKyBcIiBDXCIgKyB0YXJnZXRYICsgXCIsXCIgKyBzb3VyY2VZICsgXCIgXCIgKyB0YXJnZXRZICsgXCIsXCIgKyB5KGQudGFyZ2V0LngwKSArIFwiIFwiICsgdGFyZ2V0WCArIFwiLFwiICsgbGlua1RhcmdldFkgKyBcIlwiO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocmVzdWx0KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgZnVuY3Rpb24gb25FZGl0Tm9kZShkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxlbmd0aCA9IDk7XG4gICAgICAgICAgICAgICAgdmFyIGlkID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikucmVwbGFjZSgvW15hLXpdKy9nLCAnJykuc3Vic3RyKDAsIGxlbmd0aCk7XG4gICAgICAgICAgICAgICAgYWRkQ2hpbGROb2RlKGQuaWQsIHtcbiAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwibmV3IGNoaWxkIG5vZGVcIixcbiAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBpZCxcbiAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwidHlwZTJcIlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHN0b3BQcm9wb2dhdGlvbigpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBvbkFkZE5vZGUocGFyZW50LCBjaGlsZCkge1xuICAgICAgICAgICAgICAgIHZhciBsZW5ndGggPSA5O1xuICAgICAgICAgICAgICAgIHZhciBpZCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnJlcGxhY2UoL1teYS16XSsvZywgJycpLnN1YnN0cigwLCBsZW5ndGgpO1xuICAgICAgICAgICAgICAgIGFkZENoaWxkTm9kZShwYXJlbnQuaWQsIGNoaWxkKTtcbiAgICAgICAgICAgICAgICAvLyBzdG9wUHJvcG9nYXRpb24oKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gb25SZW1vdmVOb2RlKGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBkLnBhcmVudC5jaGlsZHJlbi5pbmRleE9mKGQpO1xuICAgICAgICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGQucGFyZW50LmNoaWxkcmVuLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZpbmRJbnRoZVJvb3RBbmREZXN0b3JveShyb290LmNoaWxkcmVuLCBkKTtcbiAgICAgICAgICAgICAgICB1cGRhdGUoZC5wYXJlbnQpO1xuICAgICAgICAgICAgICAgIHN0b3BQcm9wb2dhdGlvbigpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBmaW5kSW50aGVSb290QW5kRGVzdG9yb3kobGlzdCwgbm9kZSkge1xuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChsaXN0LCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmlkID09IHZhbHVlLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBsaXN0LmluZGV4T2YodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0LnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYW5ndWxhci5pc0RlZmluZWQodmFsdWUuY2hpbGRyZW4pICYmIHZhbHVlLmNoaWxkcmVuICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaW5kSW50aGVSb290QW5kRGVzdG9yb3kodmFsdWUuY2hpbGRyZW4sIG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGZpbmRJbnRoZVJvb3RBbmRSZXBsYWNlTmFtZShsaXN0LCBub2RlKSB7XG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGxpc3QsIGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuaWQgPT0gdmFsdWUuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IGxpc3QuaW5kZXhPZih2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RbaW5kZXhdLm5hbWUgPSBub2RlLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYW5ndWxhci5pc0RlZmluZWQodmFsdWUuY2hpbGRyZW4pICYmIHZhbHVlLmNoaWxkcmVuICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaW5kSW50aGVSb290QW5kRGVzdG9yb3kodmFsdWUuY2hpbGRyZW4sIG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGFkZENoaWxkTm9kZShwYXJlbnRJZCwgbmV3Tm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciBub2RlID0gZDMuc2VsZWN0KCcjJyArICdub2RlLScgKyBwYXJlbnRJZCk7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVEYXRhID0gbm9kZS5kYXR1bSgpO1xuICAgICAgICAgICAgICAgIGlmIChub2RlRGF0YS5jaGlsZHJlbiA9PT0gdW5kZWZpbmVkICYmIG5vZGVEYXRhLl9jaGlsZHJlbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEYXRhLmNoaWxkcmVuID0gW25ld05vZGVdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm9kZURhdGEuX2NoaWxkcmVuICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURhdGEuX2NoaWxkcmVuLnB1c2gobmV3Tm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIHRvZ2dsZShub2RlRGF0YSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub2RlRGF0YS5jaGlsZHJlbiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVEYXRhLmNoaWxkcmVuLnB1c2gobmV3Tm9kZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub2RlRGF0YS5fY2hpbGRyZW4gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBub2RlRGF0YS5fY2hpbGRyZW4gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZURhdGEuX2NoaWxkcmVuLnB1c2gobmV3Tm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIHRvZ2dsZShub2RlRGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHVwZGF0ZShub2RlRGF0YSk7XG5cbiAgICAgICAgICAgICAgICAvLyBzdG9wUHJvcG9nYXRpb24oKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gdG9nZ2xlRW5hYmxlKGQpIHtcbiAgICAgICAgICAgICAgICBkLmVuYWJsZSA9ICFkLmVuYWJsZTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IGQzLnNlbGVjdCgnIycgKyAnbm9kZS0nICsgZC5pZCArIFwiIC5ub2RlLWxhYmVsXCIpXG4gICAgICAgICAgICAgICAgICAgIC5jbGFzc2VkKFwiZGlzYWJsZWRcIiwgIWQuZW5hYmxlKTtcbiAgICAgICAgICAgICAgICBzdG9wUHJvcG9nYXRpb24oKTtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICBmdW5jdGlvbiBzdG9wUHJvcG9nYXRpb24oKSB7XG4gICAgICAgICAgICAgICAgZDMuZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBhY3RpdmUgPSBkMy5zZWxlY3QobnVsbCk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIG9uQ2xpY2tlZE5vZGUobm9kZSkge1xuICAgICAgICAgICAgICAgIGlmIChkMy5ldmVudC5kZWZhdWx0UHJldmVudGVkKSByZXR1cm47XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cobm9kZSk7XG4gICAgICAgICAgICAgICAgdmFyIGlzUmVzZXQgPSBtYWtlQ2xpY2tlZE5vZGVBY3RpdmUodGhpcyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNSZXNldCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9UT0RPIHNjYWxlIGFjY29yZGluZyB0byB0aGUgYm91bmRzXG4gICAgICAgICAgICAgICAgLy8gdmFyIGJvdW5kcyA9IGQzLnNlbGVjdChlbGVtWzBdKS5ub2RlKCkuZ2V0QkJveCgpO1xuICAgICAgICAgICAgICAgIC8vIHZhciBzY2FsZSA9IE1hdGgubWF4KDEsIE1hdGgubWluKDgsIDAuOSAvIE1hdGgubWF4KGQueCAsIGQueSApKSk7XG4gICAgICAgICAgICAgICAgcGFuVG9UaGVOb2RlKG5vZGUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBoaWdobGlnaHRQYXRoKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAvL1RPRE8gbXVzdCBpbmNsdWRlIHRoZSByb290IG5vZGUgaW4gdGhlIGFycmF5XG4gICAgICAgICAgICAgICAgLy9QYXRoIGFycmF5IHRvIHN0b3JlIG5vZGVzXG4gICAgICAgICAgICAgICAgdmFyIHBhdGggPSBzZWFyY2hXaXRoaW5UcmVlKHZtLnRyZWVkYXRhLCBub2RlLm5hbWUsIFtdKTtcblxuICAgICAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChwYXRoKSkge1xuICAgICAgICAgICAgICAgICAgICAvL2Z1bmN0aW9uIHRvIG9wZW4gcGF0aHNcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJIaWdoTGlnaHRMaW5rcyhsYXN0U2VhcmNoZWRQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0TGlua3MocGF0aCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NlYXJjaGVkIG5vZGUgJyArIG5vZGUubmFtZSArICcgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbGFzdFNlYXJjaGVkUGF0aCA9IHBhdGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGhpZ2hsaWdodExpbmtzKHBhdGgpIHtcblxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChwYXRoLCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vVE9ETyBhc3N1bWUgdGhhdCBpZCBvZiB0aGUgcm9vdCBub2RlIGlzIDEsLm1ha2UgdGhpcyBtb3JlIGNvbnNpc3RlbnQgbGF0ZXJcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgKHZhbHVlLmlkICE9PSdpZDEnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlLmNsYXNzID0gJ2hpZ2hsaWdodC1saW5rJztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlLl9jaGlsZHJlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUuY2hpbGRyZW4gPSB2YWx1ZS5fY2hpbGRyZW47XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZS5fY2hpbGRyZW4gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjbGVhckhpZ2hMaWdodExpbmtzKHBhdGgpIHtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2gocGF0aCwgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUuY2xhc3MgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlLl9jaGlsZHJlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUuY2hpbGRyZW4gPSB2YWx1ZS5fY2hpbGRyZW47XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZS5fY2hpbGRyZW4gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gcmVtb3ZlSGlnaGxpZ2h0KG5vZGUpIHtcbiAgICAgICAgICAgICAgICBpZiAobm9kZS5jbGFzcyA9PT0gJ2hpZ2hsaWdodC1saW5rJykge1xuICAgICAgICAgICAgICAgICAgICBub2RlLmNsYXNzID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL3NlYXJjaCBvbiB0cmVlIGZvciBhIGxpbmtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHNlYXJjaFdpdGhpblRyZWUobm9kZSwgc2VhcmNoS2V5LCBwYXRoKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vZGUubmFtZSA9PT0gc2VhcmNoS2V5KSB7IC8vaWYgc2VhcmNoIGlzIGZvdW5kIHJldHVybiwgYWRkIHRoZSBvYmplY3QgdG8gdGhlIHBhdGggYW5kIHJldHVybiBpdFxuICAgICAgICAgICAgICAgICAgICBwYXRoLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXRoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChub2RlLmNoaWxkcmVuIHx8IG5vZGUuX2NoaWxkcmVuKSB7IC8vaWYgY2hpbGRyZW4gYXJlIGNvbGxhcHNlZCBkMyBvYmplY3Qgd2lsbCBoYXZlIHRoZW0gaW5zdGFudGlhdGVkIGFzIF9jaGlsZHJlblxuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW4gPSAobm9kZS5jaGlsZHJlbikgPyBub2RlLmNoaWxkcmVuIDogbm9kZS5fY2hpbGRyZW47XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGgucHVzaChub2RlKTsvLyB3ZSBhc3N1bWUgdGhpcyBwYXRoIGlzIHRoZSByaWdodCBvbmVcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmb3VuZCA9IHNlYXJjaFdpdGhpblRyZWUoY2hpbGRyZW5baV0sIHNlYXJjaEtleSwgcGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm91bmQpIHsvLyB3ZSB3ZXJlIHJpZ2h0LCB0aGlzIHNob3VsZCByZXR1cm4gdGhlIGJ1YmJsZWQtdXAgcGF0aCBmcm9tIHRoZSBmaXJzdCBpZiBzdGF0ZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm91bmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsvL3dlIHdlcmUgd3JvbmcsIHJlbW92ZSB0aGlzIHBhcmVudCBmcm9tIHRoZSBwYXRoIGFuZCBjb250aW51ZSBpdGVyYXRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Ugey8vbm90IHRoZSByaWdodCBvYmplY3QsIHJldHVybiBmYWxzZSBzbyBpdCB3aWxsIGNvbnRpbnVlIHRvIGl0ZXJhdGUgaW4gdGhlIGxvb3BcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gbWFrZUNsaWNrZWROb2RlQWN0aXZlKGVsZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgaXNSZXNldCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmIChhY3RpdmUubm9kZSgpID09PSBlbGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzUmVzZXQgPSByZXNldCgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpc1Jlc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZS5jbGFzc2VkKFwiYWN0aXZlXCIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlID0gZDMuc2VsZWN0KGVsZW0pLmNsYXNzZWQoXCJhY3RpdmVcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gcGFuVG9UaGVOb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAvLyB2YXIgc2NhbGUgPSAxOy8vRklYTUUgYWRkIHNjYWxlIHRvIGhpZ2hlciBpZiBuZWVkXG4gICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gdG9vbFNldFNlcnZpY2UuZ2V0Wm9vbVNjYWxlKCk7XG4gICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZSA9IFstc2NhbGUgKiBub2RlLngsIC1zY2FsZSAqIG5vZGUueV07XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ25vZGUnLCBub2RlKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbm9kZSB0cmFuc2xhdGUgJywgdHJhbnNsYXRlKTtcbiAgICAgICAgICAgICAgICB2aXMudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbigxMjUwKVxuICAgICAgICAgICAgICAgICAgICAuY2FsbCh6b29tLnRyYW5zbGF0ZSh0cmFuc2xhdGUpLnNjYWxlKHNjYWxlKS5ldmVudCk7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgZnVuY3Rpb24gem9vbWVkV3JhcHBlcigpIHtcbiAgICAgICAgICAgICAgICAvLyBnLnN0eWxlKFwic3Ryb2tlLXdpZHRoXCIsIDEuNSAvIGQzLmV2ZW50LnNjYWxlICsgXCJweFwiKTtcbiAgICAgICAgICAgICAgICB2aXMuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIGQzLmV2ZW50LnRyYW5zbGF0ZSArIFwiKXNjYWxlKFwiICsgZDMuZXZlbnQuc2NhbGUgKyBcIilcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2V0KCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVzZXQgY2FsbGVkXCIpO1xuICAgICAgICAgICAgICAgIGFjdGl2ZS5jbGFzc2VkKFwiYWN0aXZlXCIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBhY3RpdmUgPSBkMy5zZWxlY3QobnVsbCk7XG5cbiAgICAgICAgICAgICAgICAvL1RPRE8gcmVtb3ZlIEFTQVBcbiAgICAgICAgICAgICAgICAvKiAgICAgICAgICAgICAgICB2aXMudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZHVyYXRpb24oNzUwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoem9vbU9iamVjdC50cmFuc2xhdGUoWzE1MCwgMTAwXSkuc2NhbGUoMSkuZXZlbnQpOyovXG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0VHJlZU5vZGVCeU9iamVjdChvYmplY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgdHJlZU5vZGUgPSAkZmlsdGVyKCdmaWx0ZXInKShub2RlTGlzdCwgeydpZCc6IG9iamVjdC5pZH0sIHRydWUpWzBdO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cmVlTm9kZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0VHJlZU5vZGVCeUlEKGlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRyZWVOb2RlID0gJGZpbHRlcignZmlsdGVyJykobm9kZUxpc3QsIHsnaWQnOiBpZH0sIHRydWUpWzBdO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cmVlTm9kZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gY2VudGVyVGhlUm9vdCgpIHtcbiAgICAgICAgICAgICAgICAvL1RyYW5zZm9ybSB0byB0aGUgY2VudGVyICgwLDApXG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtTm9kZSgwLCAwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gdHJhbnNmb3JtTm9kZSh4UG9zLCB5UG9zKSB7XG4gICAgICAgICAgICAgICAgdmlzLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgICAgIC8vZHVyYXRpb24gb2YgdGhlIGFuaW1hdGlvbiBvZiB0cmFuc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgIC5kdXJhdGlvbigxMDAwKVxuICAgICAgICAgICAgICAgICAgICAvLyBkZWxheSB0aW1lIGluIG1zXG4gICAgICAgICAgICAgICAgICAgIC5kZWxheSgxMDApXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJ0cmFuc2xhdGUoXCIgKyAoeFBvcykgKyBcIixcIiArICh5UG9zKSArIFwiKVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBcInNjYWxlKFwiICsgdG9vbFNldFNlcnZpY2UuZ2V0Wm9vbVNjYWxlKCkgKyBcIilcIjtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG5vZGVBY3RpdmVDbGVhckxpc3RlbmVyID0gc2NvcGUuJG9uKCdhcHA6bm9kZXM6Y2xlYXJhY3RpdmUnLCBvbkRlYWN0aXZhdGVOb2Rlcyk7XG4gICAgICAgICAgICBub2RlRGVsZXRlTGlzdGVuZXIgPSBzY29wZS4kb24oJ2FwcDpub2RlczpkZWxldGUnLCBvbk5vZGVEZWxldGUpO1xuICAgICAgICAgICAgbm9kZUFmdGVyQWRkTGlzdGVuZXIgPSBzY29wZS4kb24oJ2FwcDpub2RlczphZGQ6OmFmdGVyJywgb25Ob2RlQWZ0ZXJBZGQpO1xuICAgICAgICAgICAgbm9kZUFmdGVyVXBkYXRlTGlzdGVuZXIgPSBzY29wZS4kb24oJ2FwcDpub2Rlczp1cGRhdGU6OmFmdGVyJywgb25Ob2RlQWZ0ZXJVcGRhdGUpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBvbk5vZGVBZnRlclVwZGF0ZShldiwgZGF0YSkge1xuICAgICAgICAgICAgICAgIGZpbmRJbnRoZVJvb3RBbmRSZXBsYWNlTmFtZShyb290LmNoaWxkcmVuLCBkYXRhLmxhc3RFZGl0ZWROb2RlKTtcbiAgICAgICAgICAgICAgICB1cGRhdGUoZGF0YS5sYXN0RWRpdGVkTm9kZSk7XG4gICAgICAgICAgICAgICAgc3RvcFByb3BvZ2F0aW9uKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIG9uTm9kZUFmdGVyQWRkKGV2LCBkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc29sdmVkTm9kZSA9IGdldFRyZWVOb2RlQnlJRChkYXRhLnBhcmVudE5vZGUuaWQpO1xuICAgICAgICAgICAgICAgIG9uQWRkTm9kZShyZXNvbHZlZE5vZGUsIGRhdGEubGFzdEFkZGVkTm9kZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIG9uTm9kZURlbGV0ZShldiwgZGF0YSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgIHZhciByZXNvbHZlZE5vZGUgPSBnZXRUcmVlTm9kZUJ5SUQoZGF0YS5ub2RlSUQpO1xuICAgICAgICAgICAgICAgIG9uUmVtb3ZlTm9kZShyZXNvbHZlZE5vZGUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBtYWtlTm9kZUFjdGl2ZShpZCkge1xuICAgICAgICAgICAgICAgIHZhciBub2RlTGlzdCA9IGQzLnNlbGVjdEFsbChcIi5ub2RlLVwiICsgaWQudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KG5vZGVMaXN0WzBdKS5hZGRDbGFzcygnYWN0aXZlLW5vZGUnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gY2xlYXJBbGxBY3RpdmVOb2RlcygpIHtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZUxpc3QgPSBkMy5zZWxlY3RBbGwoXCIubm9kZS1sYWJlbFwiKTtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2gobm9kZUxpc3QsIGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudCh2KS5yZW1vdmVDbGFzcygnYWN0aXZlLW5vZGUnKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gb25EZWFjdGl2YXRlTm9kZXMoZXYsIGRhdGEpIHtcbiAgICAgICAgICAgICAgICBjbGVhckFsbEFjdGl2ZU5vZGVzKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGludGVycG9sYXRlWm9vbSh0cmFuc2xhdGUsIHNjYWxlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQzLnRyYW5zaXRpb24oKS5kdXJhdGlvbigyNTApLnR3ZWVuKFwid2hlZWwuem9vbVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpVHJhbnNsYXRlID0gZDMuaW50ZXJwb2xhdGUoem9vbS50cmFuc2xhdGUoKSwgdHJhbnNsYXRlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlTY2FsZSA9IGQzLmludGVycG9sYXRlKHpvb20uc2NhbGUoKSwgc2NhbGUpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHpvb21cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2NhbGUoaVNjYWxlKHQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50cmFuc2xhdGUoaVRyYW5zbGF0ZSh0KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB6b29tZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gem9vbUNsaWNrKHN0YXR1cykge1xuICAgICAgICAgICAgICAgIHZhciBkaXJlY3Rpb24gPSAxLFxuICAgICAgICAgICAgICAgICAgICBmYWN0b3IgPSAwLjIsXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldF96b29tID0gMSxcbiAgICAgICAgICAgICAgICAgICAgY2VudGVyID0gW3cgLyAyLCBoIC8gMl0sXG4gICAgICAgICAgICAgICAgICAgIGV4dGVudCA9IHpvb20uc2NhbGVFeHRlbnQoKSxcbiAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRlID0gem9vbS50cmFuc2xhdGUoKSxcbiAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRlMCA9IFtdLFxuICAgICAgICAgICAgICAgICAgICBsID0gW10sXG4gICAgICAgICAgICAgICAgICAgIHZpZXcgPSB7eDogdHJhbnNsYXRlWzBdLCB5OiB0cmFuc2xhdGVbMV0sIGs6IHpvb20uc2NhbGUoKX07XG5cbiAgICAgICAgICAgICAgICAvLyBkMy5ldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9IChzdGF0dXMgPT09ICdpbmNyZW1lbnQnKSA/IDEgOiAtMTtcbiAgICAgICAgICAgICAgICB0YXJnZXRfem9vbSA9IHpvb20uc2NhbGUoKSAqICgxICsgZmFjdG9yICogZGlyZWN0aW9uKTtcblxuICAgICAgICAgICAgICAgIGlmICh0YXJnZXRfem9vbSA8IGV4dGVudFswXSB8fCB0YXJnZXRfem9vbSA+IGV4dGVudFsxXSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdHJhbnNsYXRlMCA9IFsoY2VudGVyWzBdIC0gdmlldy54KSAvIHZpZXcuaywgKGNlbnRlclsxXSAtIHZpZXcueSkgLyB2aWV3LmtdO1xuICAgICAgICAgICAgICAgIHZpZXcuayA9IHRhcmdldF96b29tO1xuICAgICAgICAgICAgICAgIGwgPSBbdHJhbnNsYXRlMFswXSAqIHZpZXcuayArIHZpZXcueCwgdHJhbnNsYXRlMFsxXSAqIHZpZXcuayArIHZpZXcueV07XG5cbiAgICAgICAgICAgICAgICB2aWV3LnggKz0gY2VudGVyWzBdIC0gbFswXTtcbiAgICAgICAgICAgICAgICB2aWV3LnkgKz0gY2VudGVyWzFdIC0gbFsxXTtcblxuICAgICAgICAgICAgICAgIGludGVycG9sYXRlWm9vbSh6b29tLnRyYW5zbGF0ZSgpLCB2aWV3LmspO1xuICAgICAgICAgICAgICAgIC8vIHpvb21lZCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiB6b29tZWQoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coem9vbS5zY2FsZSgpKTtcbiAgICAgICAgICAgICAgICB0b29sU2V0U2VydmljZS5zZXRab29tU2NhbGUoem9vbS5zY2FsZSgpKTtcbiAgICAgICAgICAgICAgICB2aXMuYXR0cihcInRyYW5zZm9ybVwiLFxuICAgICAgICAgICAgICAgICAgICBcInRyYW5zbGF0ZShcIiArIHpvb20udHJhbnNsYXRlKCkgKyBcIilcIiArXG4gICAgICAgICAgICAgICAgICAgIFwic2NhbGUoXCIgKyB0b29sU2V0U2VydmljZS5nZXRab29tU2NhbGUoKSArIFwiKVwiXG4gICAgICAgICAgICAgICAgICAgIC8vIFwic2NhbGUoXCIgKyB6b29tLnNjYWxlKCkgKyBcIilcIlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgLy8gem9vbVdpdGhUd2VlbigpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiB6b29tV2l0aFR3ZWVuKCl7XG4gICAgICAgICAgICAgICAgdmlzLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIHpvb20udHJhbnNsYXRlKCkgKyBcIilzY2FsZShcIiArIHRvb2xTZXRTZXJ2aWNlLmdldFpvb21TY2FsZSgpICsgXCIpXCIpO1xuICAgICAgICAgICAgICAgIC8qICAgICAgICAgICAgICAgICAgICAuZWFjaChcImVuZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW50ZXJwb2xhdGVab29tKHpvb20udHJhbnNsYXRlKCksem9vbS5zY2FsZSgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOyovXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBkZXN0cm95TGlzdGVuZXIpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBkZXN0cm95TGlzdGVuZXIoKSB7XG4gICAgICAgICAgICAgICAgbm9kZUFjdGl2ZUNsZWFyTGlzdGVuZXIoKTtcbiAgICAgICAgICAgICAgICBub2RlRGVsZXRlTGlzdGVuZXIoKTtcbiAgICAgICAgICAgICAgICBub2RlQWZ0ZXJBZGRMaXN0ZW5lcigpO1xuICAgICAgICAgICAgICAgIG5vZGVBZnRlclVwZGF0ZUxpc3RlbmVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdHJlZVZpZXdEaXJlY3RpdmU7XG4gICAgfVxuXG4gICAgLypAbmdJbmplY3QqL1xuICAgIGZ1bmN0aW9uIFRyZWVWaWV3RGlyZWN0aXZlQ29udHJvbGxlcigkcm9vdFNjb3BlLCAkc2NvcGUsIHRyZWVWaWV3U2VydmljZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5tYWtlQ2FsbEJhY2sgPSBtYWtlQ2FsbEJhY2s7XG5cbiAgICAgICAgY29uc29sZS5sb2codm0uc2VhcmNoYWJsZUxpc3QpO1xuXG4gICAgICAgIGZ1bmN0aW9uIG1ha2VDYWxsQmFjayhpZGVudGlmaWVyLCBub2RlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnY2FsbGVkIHRyZWV2aWV3IGNhbGwgYmFjayBhYm4nKTtcbiAgICAgICAgICAgICRzY29wZS52bVtpZGVudGlmaWVyXSh7bm9kZTogbm9kZX0pO1xuICAgICAgICB9XG5cbiAgICB9XG59KSgpO1xuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHVzZXIgb24gNi8xLzE3LlxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdvcmdDaGFydCcpLmZhY3RvcnkoJ3RyZWVWaWV3U2VydmljZScsIHRyZWVWaWV3U2VydmljZSk7XG5cbiAgICBmdW5jdGlvbiB0cmVlVmlld1NlcnZpY2UoJGZpbHRlcikge1xuICAgICAgICB2YXIgc2VsZWN0ZWROb2RlID0gbnVsbDtcbiAgICAgICAgdmFyIG5vZGVzID0gW107XG5cbiAgICAgICAgdmFyIHNlcnZpY2VFeHBvc2FibGUgPSB7XG4gICAgICAgICAgICBzZXRTZWFyY2hlZE5vZGU6IHNldFNlYXJjaGVkTm9kZSxcbiAgICAgICAgICAgIGdldFNlYXJjaGVkTm9kZTogZ2V0U2VhcmNoZWROb2RlLFxuICAgICAgICAgICAgc2V0Tm9kZXM6IHNldE5vZGVzLFxuICAgICAgICAgICAgcHVzaE5vZGU6IHB1c2hOb2RlLFxuICAgICAgICAgICAgZ2V0Tm9kZXM6IGdldE5vZGVzLFxuICAgICAgICAgICAgZmluZEJ5SWQ6IGZpbmRCeUlkXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2VFeHBvc2FibGU7XG5cbiAgICAgICAgZnVuY3Rpb24gZmluZEJ5SWQoaWQpIHtcbiAgICAgICAgICAgIHZhciB0cmVlTm9kZSA9ICRmaWx0ZXIoJ2ZpbHRlcicpKG5vZGVzLCB7J2lkJzogaWR9LCB0cnVlKVswXTtcbiAgICAgICAgICAgIHJldHVybiB0cmVlTm9kZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldE5vZGVzKHNldE9mbm9kZXMpIHtcbiAgICAgICAgICAgIG5vZGVzID0gc2V0T2Zub2RlcztcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldE5vZGVzKCkge1xuICAgICAgICAgICAgcmV0dXJuIG5vZGVzO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcHVzaE5vZGUobm9kZSkge1xuICAgICAgICAgICAgbm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldFNlYXJjaGVkTm9kZShub2RlKSB7XG4gICAgICAgICAgICBzZWxlY3RlZE5vZGUgPSBub2RlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0U2VhcmNoZWROb2RlKCkge1xuICAgICAgICAgICAgcmV0dXJuIHNlbGVjdGVkTm9kZTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdXNlciBvbiA2LzIzLzE3LlxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICBhbmd1bGFyLm1vZHVsZSgnb3JnQ2hhcnQnKS5kaXJlY3RpdmUoJ3RyaW1Xb3JkJywgdHJpbVdvcmQpO1xuXG4gICAgLypAbmdJbmplY3QqL1xuICAgIGZ1bmN0aW9uIHRyaW1Xb3JkKCkge1xuICAgICAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPHNwYW4gbmctYmluZD1cInZtLnBhcnNlZFRleHRcIj48bWQtdG9vbHRpcCBuZy1pZj1cInZtLmlzVG9vbFRpcE5lZWQoKVwiIG1kLWRpcmVjdGlvbj1cInZtLndvcmRPcHRpb25zLnRvb2xUaXBEaXJlY3Rpb25cIj57ezo6dm0ud29yZH19PC9tZC10b29sdGlwPjwvc3Bhbj4nLFxuICAgICAgICAgICAgc2NvcGU6IHt9LFxuICAgICAgICAgICAgY29udHJvbGxlcjogdHJpbVdvcmRDb250cm9sbGVyLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgbGluazogbGluayxcbiAgICAgICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHtcbiAgICAgICAgICAgICAgICB3b3JkT3B0aW9uczonPScsXG4gICAgICAgICAgICAgICAgd29yZDonPSdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW0sIGF0dHIsdm0pIHtcblxuICAgICAgICAgICAgdm0uaXNUb29sVGlwTmVlZCA9IGlzVG9vbFRpcE5lZWQ7XG5cbiAgICAgICAgICAgIG9uSW5pdCgpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBvbkluaXQoKXtcbiAgICAgICAgICAgICAgICBhY3RpdmF0ZVdhdGNoZXJzKCk7XG4gICAgICAgICAgICAgICAgcGFyc2VUZXh0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlV2F0Y2hlcnMoKXtcbiAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2goYW5ndWxhci5iaW5kKHZtLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2bS53b3JkO1xuICAgICAgICAgICAgICAgIH0pLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnd29yZCBjaGFuZ2UgdG8gJyArIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VUZXh0KCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHRyaW1Xb3JkKCkge1xuICAgICAgICAgICAgICAgIHZhciBmcm9tVmFsdWUgPSBwYXJzZUludCh2bS53b3JkT3B0aW9ucy5mcm9tKTtcbiAgICAgICAgICAgICAgICB2YXIgdG9WYWx1ZSA9IHBhcnNlSW50KHZtLndvcmRPcHRpb25zLnVudGlsKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdm0ud29yZC5zdWJzdHJpbmcoZnJvbVZhbHVlLCB0b1ZhbHVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gaXNUb29sVGlwTmVlZCgpe1xuICAgICAgICAgICAgICAgIHJldHVybiB2bS53b3JkT3B0aW9ucy50b29sVGlwPT0ndHJ1ZSc/dHJ1ZTpmYWxzZVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBwYXJzZVRleHQoKXtcbiAgICAgICAgICAgICAgICB2bS5wYXJzZWRUZXh0ID0gdHJpbVdvcmQoKTtcbiAgICAgICAgICAgICAgICAodm0ud29yZC5sZW5ndGg+cGFyc2VJbnQodm0ud29yZE9wdGlvbnMudW50aWwpKT92bS5wYXJzZWRUZXh0ID0gdm0ucGFyc2VkVGV4dC5jb25jYXQoXCIgLi4uXCIpOnZtLnBhcnNlZFRleHQ7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLypAbmdJbmplY3QqL1xuICAgIGZ1bmN0aW9uIHRyaW1Xb3JkQ29udHJvbGxlcigpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgIH1cbn0pKCk7XG4iXX0=
